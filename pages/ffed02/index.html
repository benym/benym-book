<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JMH-åŸºå‡†æµ‹è¯•æ¡†æ¶ | benymçš„çŸ¥è¯†ç¬”è®°</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/img/favicon-two.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <meta name="description" content="æ€»ç»“">
    <meta name="keywords" content="Java,benym,blog,knowledge">
    <meta name="theme-color" content="#ff954b">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/assets/css/0.styles.a8537680.css" as="style"><link rel="preload" href="/assets/js/app.7da65b61.js" as="script"><link rel="preload" href="/assets/js/2.97c812e5.js" as="script"><link rel="preload" href="/assets/js/18.4a6b0db1.js" as="script"><link rel="preload" href="/assets/js/6.d98d2c99.js" as="script"><link rel="prefetch" href="/assets/js/10.9853697e.js"><link rel="prefetch" href="/assets/js/100.21225358.js"><link rel="prefetch" href="/assets/js/101.d9ab2d05.js"><link rel="prefetch" href="/assets/js/102.3cd48b78.js"><link rel="prefetch" href="/assets/js/103.c09ea1aa.js"><link rel="prefetch" href="/assets/js/104.c8c02af6.js"><link rel="prefetch" href="/assets/js/105.52cd29f6.js"><link rel="prefetch" href="/assets/js/106.5cb7da13.js"><link rel="prefetch" href="/assets/js/107.df23df45.js"><link rel="prefetch" href="/assets/js/108.f20b0f30.js"><link rel="prefetch" href="/assets/js/109.9bb67054.js"><link rel="prefetch" href="/assets/js/11.ca2d9138.js"><link rel="prefetch" href="/assets/js/110.111a638b.js"><link rel="prefetch" href="/assets/js/111.8f8afc83.js"><link rel="prefetch" href="/assets/js/112.757a4959.js"><link rel="prefetch" href="/assets/js/113.a2cecbc5.js"><link rel="prefetch" href="/assets/js/114.ad25d1ea.js"><link rel="prefetch" href="/assets/js/115.ddbdaf6c.js"><link rel="prefetch" href="/assets/js/116.6be5b96e.js"><link rel="prefetch" href="/assets/js/117.8a4694bf.js"><link rel="prefetch" href="/assets/js/118.b270dcbf.js"><link rel="prefetch" href="/assets/js/119.f47e4efd.js"><link rel="prefetch" href="/assets/js/12.d198d965.js"><link rel="prefetch" href="/assets/js/120.345367df.js"><link rel="prefetch" href="/assets/js/121.fd0f7b5b.js"><link rel="prefetch" href="/assets/js/122.3c95f079.js"><link rel="prefetch" href="/assets/js/123.7a4d0a3f.js"><link rel="prefetch" href="/assets/js/124.bf9de739.js"><link rel="prefetch" href="/assets/js/125.d981f47a.js"><link rel="prefetch" href="/assets/js/126.cc2bfbf1.js"><link rel="prefetch" href="/assets/js/127.82423d10.js"><link rel="prefetch" href="/assets/js/128.cfee57ab.js"><link rel="prefetch" href="/assets/js/129.8d6122c9.js"><link rel="prefetch" href="/assets/js/13.da453c0a.js"><link rel="prefetch" href="/assets/js/130.56e42370.js"><link rel="prefetch" href="/assets/js/131.8e1549cd.js"><link rel="prefetch" href="/assets/js/132.7290c22c.js"><link rel="prefetch" href="/assets/js/133.9dded9ab.js"><link rel="prefetch" href="/assets/js/134.e63f8b73.js"><link rel="prefetch" href="/assets/js/135.636d5537.js"><link rel="prefetch" href="/assets/js/136.01d27ae9.js"><link rel="prefetch" href="/assets/js/137.69c34a56.js"><link rel="prefetch" href="/assets/js/138.6345cd27.js"><link rel="prefetch" href="/assets/js/139.46753d5a.js"><link rel="prefetch" href="/assets/js/14.c14eca74.js"><link rel="prefetch" href="/assets/js/140.79f4ed99.js"><link rel="prefetch" href="/assets/js/141.1f4ce18d.js"><link rel="prefetch" href="/assets/js/142.c7d76756.js"><link rel="prefetch" href="/assets/js/143.94182c42.js"><link rel="prefetch" href="/assets/js/144.a755b388.js"><link rel="prefetch" href="/assets/js/145.2edc35bd.js"><link rel="prefetch" href="/assets/js/146.0a5d59a2.js"><link rel="prefetch" href="/assets/js/147.a2aa583c.js"><link rel="prefetch" href="/assets/js/148.60ffd3b6.js"><link rel="prefetch" href="/assets/js/149.0c5ef55d.js"><link rel="prefetch" href="/assets/js/15.32b2ad78.js"><link rel="prefetch" href="/assets/js/150.b690afe0.js"><link rel="prefetch" href="/assets/js/151.2dab8d21.js"><link rel="prefetch" href="/assets/js/152.fb5fa4d0.js"><link rel="prefetch" href="/assets/js/153.f06002cb.js"><link rel="prefetch" href="/assets/js/154.064f36c7.js"><link rel="prefetch" href="/assets/js/155.c7001a89.js"><link rel="prefetch" href="/assets/js/156.79f04fed.js"><link rel="prefetch" href="/assets/js/157.ccb2c1c9.js"><link rel="prefetch" href="/assets/js/158.6986b953.js"><link rel="prefetch" href="/assets/js/159.5eabcbfb.js"><link rel="prefetch" href="/assets/js/16.75fcf71a.js"><link rel="prefetch" href="/assets/js/160.fde71339.js"><link rel="prefetch" href="/assets/js/161.2c07fb78.js"><link rel="prefetch" href="/assets/js/162.4a6e0b88.js"><link rel="prefetch" href="/assets/js/163.5a4849a2.js"><link rel="prefetch" href="/assets/js/164.7ca57bcb.js"><link rel="prefetch" href="/assets/js/165.3c937478.js"><link rel="prefetch" href="/assets/js/166.d4453e35.js"><link rel="prefetch" href="/assets/js/167.1b60b2dc.js"><link rel="prefetch" href="/assets/js/168.082ba541.js"><link rel="prefetch" href="/assets/js/169.badb1975.js"><link rel="prefetch" href="/assets/js/17.71a633a4.js"><link rel="prefetch" href="/assets/js/170.20036ad5.js"><link rel="prefetch" href="/assets/js/171.dcb7154d.js"><link rel="prefetch" href="/assets/js/172.8f6e4a7a.js"><link rel="prefetch" href="/assets/js/173.c50451e7.js"><link rel="prefetch" href="/assets/js/174.a0589591.js"><link rel="prefetch" href="/assets/js/175.3d37226e.js"><link rel="prefetch" href="/assets/js/176.6fc2b0ba.js"><link rel="prefetch" href="/assets/js/177.7b97a175.js"><link rel="prefetch" href="/assets/js/178.1b3db9d2.js"><link rel="prefetch" href="/assets/js/179.0d9659e4.js"><link rel="prefetch" href="/assets/js/180.c441d278.js"><link rel="prefetch" href="/assets/js/181.de2bc72d.js"><link rel="prefetch" href="/assets/js/182.fe9bfb45.js"><link rel="prefetch" href="/assets/js/183.5179649d.js"><link rel="prefetch" href="/assets/js/184.80a4653c.js"><link rel="prefetch" href="/assets/js/185.e8401828.js"><link rel="prefetch" href="/assets/js/186.fc26e9ef.js"><link rel="prefetch" href="/assets/js/187.f4f727d0.js"><link rel="prefetch" href="/assets/js/188.802d5121.js"><link rel="prefetch" href="/assets/js/189.7c9a8e1e.js"><link rel="prefetch" href="/assets/js/19.f30de5fd.js"><link rel="prefetch" href="/assets/js/190.919a8214.js"><link rel="prefetch" href="/assets/js/191.58780618.js"><link rel="prefetch" href="/assets/js/192.b70a4a5f.js"><link rel="prefetch" href="/assets/js/193.8498ffb4.js"><link rel="prefetch" href="/assets/js/194.7ab729d4.js"><link rel="prefetch" href="/assets/js/195.2523ba72.js"><link rel="prefetch" href="/assets/js/196.5b5d8710.js"><link rel="prefetch" href="/assets/js/197.54b87d27.js"><link rel="prefetch" href="/assets/js/198.f56aa135.js"><link rel="prefetch" href="/assets/js/199.50826853.js"><link rel="prefetch" href="/assets/js/20.7709575c.js"><link rel="prefetch" href="/assets/js/200.fb62437e.js"><link rel="prefetch" href="/assets/js/201.238916e7.js"><link rel="prefetch" href="/assets/js/202.cf0cab65.js"><link rel="prefetch" href="/assets/js/203.6da8dbe5.js"><link rel="prefetch" href="/assets/js/204.0ed977a9.js"><link rel="prefetch" href="/assets/js/205.78269c54.js"><link rel="prefetch" href="/assets/js/206.5e063cd9.js"><link rel="prefetch" href="/assets/js/207.5f7ffc25.js"><link rel="prefetch" href="/assets/js/208.1eea42e3.js"><link rel="prefetch" href="/assets/js/209.8bb03325.js"><link rel="prefetch" href="/assets/js/21.1cfaae26.js"><link rel="prefetch" href="/assets/js/210.67e4f4cc.js"><link rel="prefetch" href="/assets/js/211.5ac8f691.js"><link rel="prefetch" href="/assets/js/212.5fbad23e.js"><link rel="prefetch" href="/assets/js/213.ece73b89.js"><link rel="prefetch" href="/assets/js/214.bf56b7a7.js"><link rel="prefetch" href="/assets/js/215.5719300a.js"><link rel="prefetch" href="/assets/js/216.bff094af.js"><link rel="prefetch" href="/assets/js/217.896869a4.js"><link rel="prefetch" href="/assets/js/218.c23e6bd0.js"><link rel="prefetch" href="/assets/js/219.fa250dc0.js"><link rel="prefetch" href="/assets/js/22.b58e6b46.js"><link rel="prefetch" href="/assets/js/220.0783c24d.js"><link rel="prefetch" href="/assets/js/221.d78aa47d.js"><link rel="prefetch" href="/assets/js/222.c4dcf0c2.js"><link rel="prefetch" href="/assets/js/223.1bb52663.js"><link rel="prefetch" href="/assets/js/224.8a9df787.js"><link rel="prefetch" href="/assets/js/225.b56c7d6b.js"><link rel="prefetch" href="/assets/js/226.5dfe1b55.js"><link rel="prefetch" href="/assets/js/227.a34eec50.js"><link rel="prefetch" href="/assets/js/228.80ea352d.js"><link rel="prefetch" href="/assets/js/229.59cc0f7d.js"><link rel="prefetch" href="/assets/js/23.9c60b848.js"><link rel="prefetch" href="/assets/js/230.95b6dcaf.js"><link rel="prefetch" href="/assets/js/231.5cb355eb.js"><link rel="prefetch" href="/assets/js/232.33b37602.js"><link rel="prefetch" href="/assets/js/233.6b2ae1ff.js"><link rel="prefetch" href="/assets/js/234.8ff52c50.js"><link rel="prefetch" href="/assets/js/235.4fbe8694.js"><link rel="prefetch" href="/assets/js/236.2b3f3a29.js"><link rel="prefetch" href="/assets/js/237.697787df.js"><link rel="prefetch" href="/assets/js/238.882aa66e.js"><link rel="prefetch" href="/assets/js/239.96d4fcb6.js"><link rel="prefetch" href="/assets/js/24.1d075c58.js"><link rel="prefetch" href="/assets/js/240.cbe259e8.js"><link rel="prefetch" href="/assets/js/241.8d3e5ce3.js"><link rel="prefetch" href="/assets/js/242.c9755bdf.js"><link rel="prefetch" href="/assets/js/243.e92ecaf3.js"><link rel="prefetch" href="/assets/js/244.b3806484.js"><link rel="prefetch" href="/assets/js/245.ffdd9b21.js"><link rel="prefetch" href="/assets/js/246.ef343e66.js"><link rel="prefetch" href="/assets/js/247.881a3223.js"><link rel="prefetch" href="/assets/js/248.2e4c8492.js"><link rel="prefetch" href="/assets/js/249.b3cc5789.js"><link rel="prefetch" href="/assets/js/25.1be14388.js"><link rel="prefetch" href="/assets/js/250.443b42d1.js"><link rel="prefetch" href="/assets/js/251.8d4b2a00.js"><link rel="prefetch" href="/assets/js/252.57a5c804.js"><link rel="prefetch" href="/assets/js/253.177fa502.js"><link rel="prefetch" href="/assets/js/254.90d7804e.js"><link rel="prefetch" href="/assets/js/255.dac7cc2d.js"><link rel="prefetch" href="/assets/js/256.a092897d.js"><link rel="prefetch" href="/assets/js/257.e128698f.js"><link rel="prefetch" href="/assets/js/258.cabcce3d.js"><link rel="prefetch" href="/assets/js/259.2ff039ec.js"><link rel="prefetch" href="/assets/js/26.19dbb7c1.js"><link rel="prefetch" href="/assets/js/260.9f8892a7.js"><link rel="prefetch" href="/assets/js/261.9938e34c.js"><link rel="prefetch" href="/assets/js/262.a80df374.js"><link rel="prefetch" href="/assets/js/263.1db84dca.js"><link rel="prefetch" href="/assets/js/264.36961f97.js"><link rel="prefetch" href="/assets/js/265.3708f799.js"><link rel="prefetch" href="/assets/js/266.c33807bd.js"><link rel="prefetch" href="/assets/js/267.852cdf16.js"><link rel="prefetch" href="/assets/js/268.8846123e.js"><link rel="prefetch" href="/assets/js/269.b4865a21.js"><link rel="prefetch" href="/assets/js/27.9fc53195.js"><link rel="prefetch" href="/assets/js/270.df790185.js"><link rel="prefetch" href="/assets/js/271.5eb37442.js"><link rel="prefetch" href="/assets/js/272.e261f33f.js"><link rel="prefetch" href="/assets/js/273.6868ec2a.js"><link rel="prefetch" href="/assets/js/274.eb1268b6.js"><link rel="prefetch" href="/assets/js/275.1872e1df.js"><link rel="prefetch" href="/assets/js/276.da4aa1d8.js"><link rel="prefetch" href="/assets/js/277.155b85c0.js"><link rel="prefetch" href="/assets/js/278.b37bafb6.js"><link rel="prefetch" href="/assets/js/279.8a44b9bd.js"><link rel="prefetch" href="/assets/js/28.a4704f8e.js"><link rel="prefetch" href="/assets/js/280.50722df2.js"><link rel="prefetch" href="/assets/js/281.3541c8e5.js"><link rel="prefetch" href="/assets/js/282.dcb10c56.js"><link rel="prefetch" href="/assets/js/283.7fec3174.js"><link rel="prefetch" href="/assets/js/284.58548b11.js"><link rel="prefetch" href="/assets/js/285.f290a488.js"><link rel="prefetch" href="/assets/js/286.8ab5339c.js"><link rel="prefetch" href="/assets/js/287.94133544.js"><link rel="prefetch" href="/assets/js/288.92c8f343.js"><link rel="prefetch" href="/assets/js/289.1b59ed06.js"><link rel="prefetch" href="/assets/js/29.a2b8607e.js"><link rel="prefetch" href="/assets/js/290.d3bbc877.js"><link rel="prefetch" href="/assets/js/291.c2db96cf.js"><link rel="prefetch" href="/assets/js/292.cd41a584.js"><link rel="prefetch" href="/assets/js/293.18e2954f.js"><link rel="prefetch" href="/assets/js/294.af5db796.js"><link rel="prefetch" href="/assets/js/295.9a1442e9.js"><link rel="prefetch" href="/assets/js/296.d9a4f04d.js"><link rel="prefetch" href="/assets/js/297.22fe7d43.js"><link rel="prefetch" href="/assets/js/298.d6b4557b.js"><link rel="prefetch" href="/assets/js/299.4333aae3.js"><link rel="prefetch" href="/assets/js/3.7d266351.js"><link rel="prefetch" href="/assets/js/30.e2275638.js"><link rel="prefetch" href="/assets/js/300.a8fb7021.js"><link rel="prefetch" href="/assets/js/301.9b0918a6.js"><link rel="prefetch" href="/assets/js/302.b3c9b228.js"><link rel="prefetch" href="/assets/js/303.43e31dd1.js"><link rel="prefetch" href="/assets/js/304.e4edeab1.js"><link rel="prefetch" href="/assets/js/305.c6ad990c.js"><link rel="prefetch" href="/assets/js/306.55eca61c.js"><link rel="prefetch" href="/assets/js/307.0ef8cd67.js"><link rel="prefetch" href="/assets/js/308.2ef613b1.js"><link rel="prefetch" href="/assets/js/309.23ad01a5.js"><link rel="prefetch" href="/assets/js/31.c142eca4.js"><link rel="prefetch" href="/assets/js/310.cc769eb0.js"><link rel="prefetch" href="/assets/js/311.4e20e7b5.js"><link rel="prefetch" href="/assets/js/312.c022440c.js"><link rel="prefetch" href="/assets/js/313.1e6a56b1.js"><link rel="prefetch" href="/assets/js/314.1bcbd956.js"><link rel="prefetch" href="/assets/js/315.3f2b058d.js"><link rel="prefetch" href="/assets/js/316.a71d9c9d.js"><link rel="prefetch" href="/assets/js/317.3499dcec.js"><link rel="prefetch" href="/assets/js/32.6814e86e.js"><link rel="prefetch" href="/assets/js/33.f0b7a965.js"><link rel="prefetch" href="/assets/js/34.a5cb6e04.js"><link rel="prefetch" href="/assets/js/35.536324b2.js"><link rel="prefetch" href="/assets/js/36.0b2095dd.js"><link rel="prefetch" href="/assets/js/37.a402f608.js"><link rel="prefetch" href="/assets/js/38.abdf153a.js"><link rel="prefetch" href="/assets/js/39.cd5cc109.js"><link rel="prefetch" href="/assets/js/4.09b1f7c3.js"><link rel="prefetch" href="/assets/js/40.53baf323.js"><link rel="prefetch" href="/assets/js/41.e49e3fc0.js"><link rel="prefetch" href="/assets/js/42.77e56532.js"><link rel="prefetch" href="/assets/js/43.61a5352b.js"><link rel="prefetch" href="/assets/js/44.46a3c642.js"><link rel="prefetch" href="/assets/js/45.eafa64f4.js"><link rel="prefetch" href="/assets/js/46.f0dc3926.js"><link rel="prefetch" href="/assets/js/47.e494de78.js"><link rel="prefetch" href="/assets/js/48.0373df91.js"><link rel="prefetch" href="/assets/js/49.e7774c6a.js"><link rel="prefetch" href="/assets/js/5.6a04feac.js"><link rel="prefetch" href="/assets/js/50.a6781050.js"><link rel="prefetch" href="/assets/js/51.70a3a19a.js"><link rel="prefetch" href="/assets/js/52.8e0b7557.js"><link rel="prefetch" href="/assets/js/53.b0417839.js"><link rel="prefetch" href="/assets/js/54.61dc4790.js"><link rel="prefetch" href="/assets/js/55.b0e6ae59.js"><link rel="prefetch" href="/assets/js/56.9fea1b8a.js"><link rel="prefetch" href="/assets/js/57.e4afc64c.js"><link rel="prefetch" href="/assets/js/58.29677321.js"><link rel="prefetch" href="/assets/js/59.6623e7af.js"><link rel="prefetch" href="/assets/js/60.9f760fb5.js"><link rel="prefetch" href="/assets/js/61.e6204801.js"><link rel="prefetch" href="/assets/js/62.03c6f5b6.js"><link rel="prefetch" href="/assets/js/63.40339666.js"><link rel="prefetch" href="/assets/js/64.c142834d.js"><link rel="prefetch" href="/assets/js/65.126d0a00.js"><link rel="prefetch" href="/assets/js/66.90429673.js"><link rel="prefetch" href="/assets/js/67.8fe86fe8.js"><link rel="prefetch" href="/assets/js/68.eb26265b.js"><link rel="prefetch" href="/assets/js/69.d2440866.js"><link rel="prefetch" href="/assets/js/7.86e2c1e6.js"><link rel="prefetch" href="/assets/js/70.d2dd4b4c.js"><link rel="prefetch" href="/assets/js/71.5210473e.js"><link rel="prefetch" href="/assets/js/72.573b98b1.js"><link rel="prefetch" href="/assets/js/73.c704b6ba.js"><link rel="prefetch" href="/assets/js/74.867db1db.js"><link rel="prefetch" href="/assets/js/75.0afd0bf2.js"><link rel="prefetch" href="/assets/js/76.18cb57e1.js"><link rel="prefetch" href="/assets/js/77.d95ae80f.js"><link rel="prefetch" href="/assets/js/78.5d35626a.js"><link rel="prefetch" href="/assets/js/79.63b87827.js"><link rel="prefetch" href="/assets/js/8.d2f34832.js"><link rel="prefetch" href="/assets/js/80.47e3a6e0.js"><link rel="prefetch" href="/assets/js/81.a6b7187c.js"><link rel="prefetch" href="/assets/js/82.34b18b3f.js"><link rel="prefetch" href="/assets/js/83.cf3851ea.js"><link rel="prefetch" href="/assets/js/84.44b5e0ef.js"><link rel="prefetch" href="/assets/js/85.4aea7124.js"><link rel="prefetch" href="/assets/js/86.99a1305e.js"><link rel="prefetch" href="/assets/js/87.f3de639d.js"><link rel="prefetch" href="/assets/js/88.f6ae2ad3.js"><link rel="prefetch" href="/assets/js/89.375ecf68.js"><link rel="prefetch" href="/assets/js/9.92df87ca.js"><link rel="prefetch" href="/assets/js/90.5950faae.js"><link rel="prefetch" href="/assets/js/91.34df8e58.js"><link rel="prefetch" href="/assets/js/92.5584b174.js"><link rel="prefetch" href="/assets/js/93.58410f95.js"><link rel="prefetch" href="/assets/js/94.1232b4c6.js"><link rel="prefetch" href="/assets/js/95.564b34f8.js"><link rel="prefetch" href="/assets/js/96.3cec45e6.js"><link rel="prefetch" href="/assets/js/97.5c57b252.js"><link rel="prefetch" href="/assets/js/98.29b42bc5.js"><link rel="prefetch" href="/assets/js/99.59822fb9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a8537680.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/guideline-two-left.png" alt="benymçš„çŸ¥è¯†ç¬”è®°" class="logo"> <span class="site-name can-hide">benymçš„çŸ¥è¯†ç¬”è®°</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/pages/225727/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/225727/" class="nav-link">Java-åŸºç¡€</a></li><li class="dropdown-subitem"><a href="/pages/9786e5/" class="nav-link">Java-é›†åˆ</a></li><li class="dropdown-subitem"><a href="/pages/487c60/" class="nav-link">Java-å¤šçº¿ç¨‹ä¸å¹¶å‘</a></li><li class="dropdown-subitem"><a href="/pages/0a146e/" class="nav-link">Java-JVM</a></li><li class="dropdown-subitem"><a href="/pages/4aef64/" class="nav-link">Java-IO</a></li></ul></li><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0de67d/" class="nav-link">Python-åŸºç¡€</a></li><li class="dropdown-subitem"><a href="/pages/43f8b9/" class="nav-link">Python-æœºå™¨å­¦ä¹ </a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åˆ†å¸ƒå¼ä¸ä¸­é—´ä»¶" class="dropdown-title"><!----> <span class="title" style="display:;">åˆ†å¸ƒå¼ä¸ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b53b0f/" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----> <a href="/pages/847591/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/aaed8c/" class="nav-link">åˆ†å¸ƒå¼äº‹åŠ¡</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><a href="/pages/0f7e8e/" class="link-title">æ•°æ®åº“</a> <span class="title" style="display:none;">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0f7e8e/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><!----> <span class="title" style="display:;">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6e0b99/" class="nav-link">SpringIOC</a></li><li class="dropdown-subitem"><a href="/pages/a657d3/" class="nav-link">SpringAOP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><a href="/pages/83cdcf/" class="link-title">ç®—æ³•</a> <span class="title" style="display:none;">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/83cdcf/" class="nav-link">å‰‘æŒ‡Offer</a></li><li class="dropdown-item"><!----> <a href="/pages/b2b5b5/" class="nav-link">LeetCode</a></li><li class="dropdown-item"><!----> <a href="/pages/8d006a/" class="nav-link">æ’åºç®—æ³•</a></li></ul></div></div><div class="nav-item"><a href="/pages/f6b758/" class="nav-link">å®è·µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¼€æºé¡¹ç›®" class="dropdown-title"><a href="/pages/3147fe/" class="link-title">å¼€æºé¡¹ç›®</a> <span class="title" style="display:none;">å¼€æºé¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Rpamis</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/3147fe/" class="nav-link">Utils</a></li><li class="dropdown-subitem"><a href="/pages/b127c7/" class="nav-link">Exception</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/pages/2c6c1b/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/2c6c1b/" class="nav-link">æ¦‚è§ˆ</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li></ul></div></div><div class="nav-item"><a href="/pages/059f1f/" class="nav-link">ç›®å½•</a></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div> <a href="https://github.com/benym/benym-book/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/sitelogo3.jpg/zipstyle"> <div class="blogger-info"><h3>benym</h3> <span>æƒŸå…¶è‰°éš¾ï¼Œæ‰æ›´æ˜¾å‹‡æ¯…ğŸ‚æƒŸå…¶ç¬ƒè¡Œï¼Œæ‰å¼¥è¶³çè´µ</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/pages/225727/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/225727/" class="nav-link">Java-åŸºç¡€</a></li><li class="dropdown-subitem"><a href="/pages/9786e5/" class="nav-link">Java-é›†åˆ</a></li><li class="dropdown-subitem"><a href="/pages/487c60/" class="nav-link">Java-å¤šçº¿ç¨‹ä¸å¹¶å‘</a></li><li class="dropdown-subitem"><a href="/pages/0a146e/" class="nav-link">Java-JVM</a></li><li class="dropdown-subitem"><a href="/pages/4aef64/" class="nav-link">Java-IO</a></li></ul></li><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/0de67d/" class="nav-link">Python-åŸºç¡€</a></li><li class="dropdown-subitem"><a href="/pages/43f8b9/" class="nav-link">Python-æœºå™¨å­¦ä¹ </a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åˆ†å¸ƒå¼ä¸ä¸­é—´ä»¶" class="dropdown-title"><!----> <span class="title" style="display:;">åˆ†å¸ƒå¼ä¸ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/b53b0f/" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----> <a href="/pages/847591/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/aaed8c/" class="nav-link">åˆ†å¸ƒå¼äº‹åŠ¡</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•°æ®åº“" class="dropdown-title"><a href="/pages/0f7e8e/" class="link-title">æ•°æ®åº“</a> <span class="title" style="display:none;">æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/0f7e8e/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><!----> <span class="title" style="display:;">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/6e0b99/" class="nav-link">SpringIOC</a></li><li class="dropdown-subitem"><a href="/pages/a657d3/" class="nav-link">SpringAOP</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><a href="/pages/83cdcf/" class="link-title">ç®—æ³•</a> <span class="title" style="display:none;">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/83cdcf/" class="nav-link">å‰‘æŒ‡Offer</a></li><li class="dropdown-item"><!----> <a href="/pages/b2b5b5/" class="nav-link">LeetCode</a></li><li class="dropdown-item"><!----> <a href="/pages/8d006a/" class="nav-link">æ’åºç®—æ³•</a></li></ul></div></div><div class="nav-item"><a href="/pages/f6b758/" class="nav-link">å®è·µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¼€æºé¡¹ç›®" class="dropdown-title"><a href="/pages/3147fe/" class="link-title">å¼€æºé¡¹ç›®</a> <span class="title" style="display:none;">å¼€æºé¡¹ç›®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Rpamis</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/3147fe/" class="nav-link">Utils</a></li><li class="dropdown-subitem"><a href="/pages/b127c7/" class="nav-link">Exception</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/pages/2c6c1b/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/2c6c1b/" class="nav-link">æ¦‚è§ˆ</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li></ul></div></div><div class="nav-item"><a href="/pages/059f1f/" class="nav-link">ç›®å½•</a></div><div class="nav-item"><a href="/about/" class="nav-link">å…³äº</a></div> <a href="https://github.com/benym/benym-book/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Java-åŸºç¡€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/225727/" class="sidebar-link">Javaåå°„è·å–ç±»å¯¹è±¡çš„ä¸‰ç§æ–¹å¼</a></li><li><a href="/pages/ddcc22/" class="sidebar-link">åŠ¨æ€ä»£ç†</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Java-é›†åˆ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/9786e5/" class="sidebar-link">ArrayListçš„æ‰©å®¹æœºåˆ¶</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Java-å¤šçº¿ç¨‹ä¸å¹¶å‘</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/487c60/" class="sidebar-link">Javaå¤šçº¿ç¨‹å®ç°çš„å‡ ç§æ–¹å¼</a></li><li><a href="/pages/5047a0/" class="sidebar-link">å¤šçº¿ç¨‹äº¤æ›¿æ‰“å°æ•°å­—â€”å¤šç§å®ç°</a></li><li><a href="/pages/bccbee/" class="sidebar-link">CountDownLatchä½¿ç”¨æ–¹æ³•</a></li><li><a href="/pages/3898a4/" class="sidebar-link">CyclicBarrierä½¿ç”¨æ–¹æ³•</a></li><li><a href="/pages/8e40cc/" class="sidebar-link">Semaphoreä½¿ç”¨æ–¹æ³•</a></li><li><a href="/pages/b1318d/" class="sidebar-link">CompletableFutureå¸¸ç”¨ç”¨æ³•åŠè¸©å‘</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>Java-JVM</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/0a146e/" class="sidebar-link">è‡ªå®šä¹‰ç±»åŠ è½½å™¨</a></li><li><a href="/pages/ffed02/" aria-current="page" class="active sidebar-link">JMH-åŸºå‡†æµ‹è¯•æ¡†æ¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#ä»€ä¹ˆæ˜¯jmh" class="sidebar-link">ä»€ä¹ˆæ˜¯JMH</a></li><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#åŒç±»å·¥å…·" class="sidebar-link">åŒç±»å·¥å…·</a></li><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#jmhä½¿ç”¨" class="sidebar-link">JMHä½¿ç”¨</a></li><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#å¸¸ç”¨æ³¨è§£è§£æ" class="sidebar-link">å¸¸ç”¨æ³¨è§£è§£æ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#benchmarkmode" class="sidebar-link">@BenchmarkMode</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#state" class="sidebar-link">@State</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#setupåŠ-teardown" class="sidebar-link">@SetupåŠ@TearDown</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#warmup" class="sidebar-link">@Warmup</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#measurement" class="sidebar-link">@Measurement</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#param" class="sidebar-link">@Param</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#threads" class="sidebar-link">@Threads</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#fork" class="sidebar-link">@Fork</a></li><li class="sidebar-sub-header level3"><a href="/pages/ffed02/#outputtimeunit" class="sidebar-link">@OutputTimeUnit</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#å¿«é€Ÿä¸Šæ‰‹" class="sidebar-link">å¿«é€Ÿä¸Šæ‰‹</a></li><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#jmh-é¿å…æ­»ä»£ç æ¶ˆé™¤é™·é˜±" class="sidebar-link">JMH-é¿å…æ­»ä»£ç æ¶ˆé™¤é™·é˜±</a></li><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#jmhå¯è§†åŒ–" class="sidebar-link">JMHå¯è§†åŒ–</a></li><li class="sidebar-sub-header level2"><a href="/pages/ffed02/#å‚è€ƒæ–‡ç« " class="sidebar-link">å‚è€ƒæ–‡ç« </a></li></ul></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>Java-IO</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/4aef64/" class="sidebar-link">æ¦‚è§ˆ</a></li></ul></section></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/pages/059f1f/#Java" data-v-06225672>Java</a></li><li data-v-06225672><a href="/pages/059f1f/#Java" data-v-06225672>Java</a></li><li data-v-06225672><a href="/pages/059f1f/#Java-JVM" data-v-06225672>Java-JVM</a></li></ul> <div class="info" data-v-06225672><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/benym" target="_blank" title="ä½œè€…" class="beLink" data-v-06225672>benym</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-12-29</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">JMH-åŸºå‡†æµ‹è¯•æ¡†æ¶<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="ä»€ä¹ˆæ˜¯jmh"><a href="#ä»€ä¹ˆæ˜¯jmh" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯JMH</h2> <p><code>JMH</code>(Java Microbenchmark Harness)ç”±OpenJDKå›¢é˜Ÿå¼€å‘ï¼Œæ˜¯ä¸€æ¬¾åŸºå‡†æµ‹è¯•å·¥å…·ã€‚ä½œä¸ºJDKå®˜æ–¹çš„åŸºå‡†æµ‹è¯•å·¥å…·ï¼Œåœ¨JDK9å¼€å§‹å·²å†…åµŒã€‚é€šå¸¸ç”¨äºä»£ç çš„æ€§èƒ½è°ƒä¼˜ï¼ŒJMHå¼€å‘è€…åŒæ ·ä¸ºJITçš„å¼€å‘è€…ï¼Œå¾—ç›Šäºä¸“ä¸šçš„JVMä¼˜åŒ–åˆ†æï¼ŒJMHå…·æœ‰é«˜ç²¾åº¦çš„ç‰¹ç‚¹ï¼Œé€‚ç”¨äºJavaåŠåŸºäºJVMçš„è¯­è¨€ã€‚é€šå¸¸JMHèƒ½å¤Ÿç»Ÿè®¡ç¨‹åºçš„<code>OPS</code>(Opeartion Per Secondï¼Œæ¯ç§’æ“ä½œé‡)ã€åŠ<code>TP99</code>ã€<code>å¹³å‡å·®</code>ç­‰ï¼ŒJMHæµ‹è¯•çš„å¯¹è±¡å¯ä»¥æ˜¯æ–¹æ³•çº§çš„ï¼Œç²’åº¦æ›´å°ã€ä¸é™äºREST APIã€‚</p> <p>å®˜æ–¹JMHä»£ç ç¤ºä¾‹åœ¨<a href="https://hg.openjdk.java.net/code-tools/jmh/file/tip/jmh-samples/src/main/java/org/openjdk/jmh/samples/" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="åŒç±»å·¥å…·"><a href="#åŒç±»å·¥å…·" class="header-anchor">#</a> åŒç±»å·¥å…·</h2> <p>ä¸ä¹‹ç±»ä¼¼çš„å·¥å…·è¿˜æœ‰Apache JMeterã€Wrkç­‰</p> <ul><li><code>Apache JMeter</code>ï¼šæä¾›GUIåˆ›å»ºå‹åŠ›æµ‹è¯•ã€è°ƒè¯•ï¼Œå¯åœ¨GUIæ‰§è¡Œå‹æµ‹(å®˜æ–¹ä¸æ¨èã€è¯¯å·®å¤§)ï¼Œä¼˜é€‰åœ¨GUIé…ç½®ååœ¨å‘½ä»¤è¡Œå‹æµ‹</li> <li><code>Wrk</code>: çƒ­é—¨å¼€æºå‹æµ‹å·¥å…·ã€Cè¯­è¨€ç¼–å†™ã€æ”¯æŒè„šæœ¬è¿›è¡Œå‹æµ‹ï¼Œè¯·æ±‚é«˜åº¦å¯å®šåˆ¶</li></ul> <p>å·®å¼‚ï¼š</p> <ul><li><code>Apache JMeter</code>: å…·æœ‰ç®€å•æ˜“æ‡‚çš„GUIï¼Œé…ç½®å‹å¥½ã€‚æ”¯æŒååé‡(Throughputã€TPS)ã€TP90ã€TP95ã€TP99ç­‰å¤šç§æŒ‡æ ‡ï¼Œç»“æœè‡ªå¸¦WebæŠ¥å‘Šå’Œæ–‡ä»¶æŠ¥å‘Šï¼Œæ”¯æŒåˆ†å¸ƒå¼å‹æµ‹ã€‚</li> <li><code>Wrk</code>: æ”¯æŒå¤šç§è„šæœ¬å·¥å…·ï¼Œå¯¹ç½‘ç»œçš„è®¾ç½®æ›´å¤šï¼Œèƒ½å¤Ÿæ›´å¥½çš„æ¨¡æ‹Ÿå‡ºç”¨æˆ·è¯·æ±‚ï¼Œå‘å‹æ•ˆç‡é«˜ï¼Œæ”¯æŒTP50ã€TP75ã€TP90ã€TP99ã€æ¯ç§’è¯·æ±‚æ•°(Requests Per Secondã€QPS)ç­‰æŒ‡æ ‡ï¼Œæ”¯æŒé€šè¿‡è„šæœ¬è‡ªå®šä¹‰æŒ‡æ ‡æ¯”ä¾‹ã€TCPé•¿/çŸ­è¿æ¥è®¾ç½®ï¼Œwrkæ²¡æœ‰GUIï¼Œä½†å­¦ä¹ æˆæœ¬ä¸é«˜ï¼Œç»“æœé€šå¸¸ä¸ºè¾“å‡ºå½¢å¼ï¼Œä»…æ”¯æŒå•æœºå‹æµ‹ã€‚</li></ul> <p>å®šä½ï¼šJMHæ›´å¤šçš„æ˜¯ä»£ç çº§ã€æ–¹æ³•çº§çš„å‹æµ‹ï¼Œèƒ½å¤Ÿåæ˜ å‡ºæŸä¸€æ–¹æ³•çš„ç“¶é¢ˆï¼Œå¯¹ç½‘ç»œåŒ…çš„å®šåˆ¶ä¸å…³å¿ƒã€‚è€ŒApache JMeterå’ŒWrkèƒ½åšçš„å¾ˆå¤šã€å¯¹äºå¤„ç†ç½‘ç»œä¸­çš„è¯·æ±‚ï¼Œå¯¹RESTæ¥å£æ›´å…·å‡†ç¡®æ€§ã€‚</p> <p>æ›´å¤šå…³äºApache JMeterå’ŒWrkçš„ä½¿ç”¨å¯é˜…è¯»è¿™ç¯‡æ–‡ç« <a href="https://cloud.tencent.com/developer/article/1896652" target="_blank" rel="noopener noreferrer">å¦‚ä½•åˆ©ç”¨Wrkä¸JMeteråšæ€§èƒ½å‹æµ‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>é€šå¸¸æ¥è¯´å‡†ç¡®çš„è¯·æ±‚å‹æµ‹ï¼Œå‘å‹æœºåº”å’ŒæœåŠ¡ä¸åœ¨åŒä¸€æœºå™¨ï¼Œæ¯•ç«Ÿä¸€ä¸ªè¯·æ±‚åˆ°æ¥æ—¶ï¼Œç½‘ç»œæƒ…å†µä¹Ÿæ˜¯è§‚æµ‹çš„é‡è¦éƒ¨åˆ†</p></div> <h2 id="jmhä½¿ç”¨"><a href="#jmhä½¿ç”¨" class="header-anchor">#</a> JMHä½¿ç”¨</h2> <p>åœ¨JDK8ä¸­ä½¿ç”¨JMHéœ€è¦å…ˆå¼•å…¥</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>openjdk<span class="token punctuation">.</span>jmh<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>jmh<span class="token operator">-</span>core<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.29</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>

<span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>openjdk<span class="token punctuation">.</span>jmh<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>jmh<span class="token operator">-</span>generator<span class="token operator">-</span>annprocess<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">1.29</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>scope<span class="token punctuation">&gt;</span></span>provided<span class="token operator">&lt;</span><span class="token operator">/</span>scope<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>JMHå®ç°äº†JSR269è§„èŒƒï¼Œå³æ³¨è§£å¤„ç†å™¨ï¼Œèƒ½åœ¨ç¼–è¯‘Javaæºç çš„æ—¶å€™è¯†åˆ«åˆ°éœ€è¦å¤„ç†çš„æ³¨è§£</p> <p>åœ¨pomæ–‡ä»¶ä¸­å¼•å…¥å¯¹åº”éœ€è¦çš„æ’ä»¶</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token generics"><span class="token punctuation">&lt;</span>plugin<span class="token punctuation">&gt;</span></span>
    <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>plugins<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>maven<span class="token operator">-</span>shade<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">2.4</span><span class="token number">.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>executions<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>execution<span class="token punctuation">&gt;</span></span>
            <span class="token generics"><span class="token punctuation">&lt;</span>phase<span class="token punctuation">&gt;</span></span><span class="token keyword">package</span><span class="token operator">&lt;</span><span class="token operator">/</span>phase<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>goals<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>goal<span class="token punctuation">&gt;</span></span>shade<span class="token operator">&lt;</span><span class="token operator">/</span>goal<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>goals<span class="token operator">&gt;</span>
            <span class="token generics"><span class="token punctuation">&lt;</span>configuration<span class="token punctuation">&gt;</span></span>
                <span class="token generics"><span class="token punctuation">&lt;</span>finalName<span class="token punctuation">&gt;</span></span>jmh<span class="token operator">-</span>demo<span class="token operator">&lt;</span><span class="token operator">/</span>finalName<span class="token operator">&gt;</span>
                <span class="token generics"><span class="token punctuation">&lt;</span>transformers<span class="token punctuation">&gt;</span></span>
                    <span class="token operator">&lt;</span>transformer implementation<span class="token operator">=</span><span class="token string">&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;</span><span class="token operator">&gt;</span>
                        <span class="token generics"><span class="token punctuation">&lt;</span>mainClass<span class="token punctuation">&gt;</span></span><span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>openjdk<span class="token punctuation">.</span>jmh<span class="token punctuation">.</span></span>Main</span><span class="token operator">&lt;</span><span class="token operator">/</span>mainClass<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>transformer<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>transformers<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>execution<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>executions<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>ä¸€ä¸ªç®€å•çš„åŸºå‡†æµ‹è¯•ä»£ç ï¼Œåªéœ€è¦åŠ å…¥<code>@Benchmark</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MHBenchmark</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        i<span class="token operator">+=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¸Šè¿°ä»£ç æ„æ€æ˜¯é‡‡ç”¨é»˜è®¤å‚æ•°ï¼Œæµ‹è¯•i+1çš„æ€§èƒ½</p> <p>å½“ç„¶è¿™æ ·çš„ç±»è¿˜ä¸èƒ½å¤Ÿè·‘èµ·æ¥ï¼ŒJMHæä¾›äº†2ç§æ–¹å¼è¿è¡Œä»£ç </p> <blockquote><p>====================== HOW TO RUN THIS TEST: ============================</p> <p>You can run this test:</p> <p>a) Via the command line:</p> <p>â€‹    $ mvn clean install</p> <p>â€‹    $ java -jar target/benchmarks.jar JMHSample_09 -f 1</p> <p>â€‹    (we requested single fork; there are also other options, see -h)</p> <p>b) Via the Java API:</p> <p>â€‹    (see the JMH homepage for possible caveats when running from IDE:  http://openjdk.java.net/projects/code-tools/jmh/)</p></blockquote> <ol><li>å‘½ä»¤è¡Œ</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code>mvn clean install
java <span class="token operator">-</span>jar xxx<span class="token punctuation">.</span>jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>é€šè¿‡Java APIï¼Œåœ¨IDEè¿è¡Œ</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RunnerException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Options</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OptionsBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span><span class="token class-name">MHBenchmark</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">result</span><span class="token punctuation">(</span><span class="token string">&quot;./result-mh.json&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">resultFormat</span><span class="token punctuation">(</span><span class="token class-name">ResultFormatType</span><span class="token punctuation">.</span><span class="token constant">JSON</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token class-name">Runner</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å¦‚æœè§‰å¾—æ¯æ¬¡è¿è¡Œéƒ½éœ€è¦æ‰‹åŠ¨è¾“å…¥å‘½ä»¤è¡Œçš„æ–¹æ³•1ç¹çï¼Œå¯ä»¥ä½¿ç”¨IDEè¿è¡Œçš„æ–¹æ³•2ï¼Œå¦‚æœæ–¹æ³•2çš„mainå‡½æ•°ä¸å¥½è®°å¿†ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨JMHæ’ä»¶<strong>JMH Java Microbenchmark Harness</strong>ï¼Œå…¶ä½œè€…ä¸º<a href="http://shipilev.net/" target="_blank" rel="noopener noreferrer">Aleksey Shipilev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œå—é›‡äºRed Hatï¼Œæ˜¯OpenJDKå­é¡¹ç›®ã€JMHçš„å¼€å‘è€…ã€‚</p> <p>åœ¨Ideaçš„Pluginsæœç´¢JMHã€å®‰è£…å³å¯</p> <p>æ’ä»¶å¯ä»¥è®©æˆ‘ä»¬èƒ½å¤Ÿä»¥JUnitç›¸åŒçš„æ–¹å¼ä½¿ç”¨JMHï¼Œä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š</p> <ul><li>è‡ªåŠ¨ç”Ÿæˆå¸¦æœ‰@Benchmarkçš„æ–¹æ³•</li> <li>è¿è¡Œå•ç‹¬çš„Benchmarkæ–¹æ³•</li> <li>è¿è¡Œç±»ä¸­æ‰€æœ‰çš„Benchmarkæ–¹æ³•</li></ul> <p>å’Œç”Ÿæˆæ„é€ æ–¹æ³•çš„Ideaç›®å½•ç›¸åŒï¼Œæ’ä»¶æ”¯æŒé€šè¿‡å³é”®ç‚¹å‡»Generateï¼Œé€‰æ‹©æ“ä½œ Generate JMH benchmark å°±å¯ä»¥ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰ @Benchmark çš„æ–¹æ³•ã€‚</p> <p><img src="https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/genBenchmark.png" alt="https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/genBenchmark.png"></p> <p>æ­¤æ—¶ä¸éœ€è¦æ‰‹åŠ¨æ‰“åŒ…ï¼Œä¹Ÿä¸éœ€è¦ç¼–å†™mainæ–¹æ³•ï¼Œç›´æ¥ç‚¹å‡»å·¦ä¾§è¿è¡Œå³å¯</p> <h2 id="å¸¸ç”¨æ³¨è§£è§£æ"><a href="#å¸¸ç”¨æ³¨è§£è§£æ" class="header-anchor">#</a> å¸¸ç”¨æ³¨è§£è§£æ</h2> <p>JMHæä¾›çš„æ³¨è§£ç›¸å½“å¤šï¼Œè¿™é‡Œä»…åˆ—å‡ºè¾ƒä¸ºå¸¸ç”¨çš„æ³¨è§£ï¼Œæ›´å¤šæ³¨è§£è¿ç”¨å¯æŸ¥çœ‹JMHå®˜æ–¹ç”¨ä¾‹</p> <h3 id="benchmarkmode"><a href="#benchmarkmode" class="header-anchor">#</a> @BenchmarkMode</h3> <p>å¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šï¼Œé…ç½®Benchmarkçš„æ¨¡å¼ï¼Œæ€»å…±æ”¯æŒå¦‚ä¸‹5ç§ï¼š</p> <ol><li><code>Throughput</code>: ååé‡ï¼Œæ¯ç§’æ‰§è¡Œäº†å¤šå°‘æ¬¡è°ƒç”¨</li> <li><code>AverageTime</code>: å¹³å‡æ—¶é—´ï¼Œæ¯æ¬¡æ“ä½œçš„å¹³å‡æ—¶é—´</li> <li><code>SampleTime</code>: å¯¹æ¯æ¬¡æ“ä½œéšæœºå–æ ·ï¼Œæœ€åè¾“å‡ºå–æ ·ç»“æœçš„åˆ†å¸ƒ</li> <li><code>SingleShotTime</code>: å•è¯æ“ä½œæ—¶é—´ï¼Œå¯è¡¡é‡å†·å¯åŠ¨æ—¶çš„æ€§èƒ½</li> <li><code>All</code>: æ‰€æœ‰æ¨¡å¼éƒ½æ‰§è¡Œä¸€æ¬¡</li></ol> <p>åŒæ—¶æ”¯æŒåˆ†ç»„æ“ä½œ</p> <p>ä½œç”¨ç±»ä¸Š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@BenchmarkMode</span><span class="token punctuation">(</span><span class="token class-name">Mode<span class="token punctuation">.</span>Throughput</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">measureShared</span><span class="token punctuation">(</span><span class="token class-name">BenchmarkState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä½œç”¨æ–¹æ³•ä¸Š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@BenchmarkMode</span><span class="token punctuation">(</span><span class="token class-name">Mode<span class="token punctuation">.</span>Throughput</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">measureShared</span><span class="token punctuation">(</span><span class="token class-name">BenchmarkState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="state"><a href="#state" class="header-anchor">#</a> @State</h3> <p>å¯ç”¨äºç±»å’Œæ–¹æ³•ä¸Šã€é€šè¿‡@Stateè¿›è¡Œæ ‡è®°æŒ‡å®šå¯¹è±¡çš„ä½œç”¨èŒƒå›´ï¼ŒJMHæ ¹æ®@Stateçš„Scopeå‚æ•°æ¥è¿›è¡Œå®ä¾‹åŒ–å’Œå…±äº«æ“ä½œã€‚æ ¹æ®ä½œç”¨èŒƒå›´çš„ä¸åŒåˆ†ä¸ºå¦‚ä¸‹3ç±»ï¼š</p> <ol><li><code>Scope.Benchmark</code>: åŸºå‡†çŠ¶æ€èŒƒå›´ã€‚åŒä¸€ç±»å‹çš„æ‰€æœ‰å®ä¾‹å°†åœ¨æ‰€æœ‰å·¥ä½œçº¿ç¨‹ä¹‹é—´å…±äº«ã€‚</li> <li><code>Scope.Group</code>: ç»„çŠ¶æ€èŒƒå›´ã€‚åŒä¸€ç±»å‹çš„æ‰€æœ‰å®ä¾‹å°†åœ¨åŒä¸€ç»„å†…çš„æ‰€æœ‰çº¿ç¨‹ä¹‹é—´å…±äº«ã€‚</li> <li><code>Scope.Thread</code>: çº¿ç¨‹çŠ¶æ€èŒƒå›´ã€‚ä½¿ç”¨çº¿ç¨‹ä½œç”¨åŸŸï¼ŒåŒä¸€ç±»å‹çš„æ‰€æœ‰å®ä¾‹éƒ½æ˜¯ä¸åŒçš„ï¼Œå³åœ¨åŒä¸€ä¸ªåŸºå‡†æµ‹è¯•ä¸­æ³¨å…¥äº†å¤šä¸ªå®ä¾‹ã€‚</li></ol> <p>å¦‚@Stateä½œç”¨äºç±»å†…éƒ¨çš„classä¸Šï¼Œé€šå¸¸ç”¨ä¸@Setupç»“åˆ</p> <p>å½“ä½¿ç”¨@Stateæ ‡è®°å†…éƒ¨ç±»åï¼Œåœ¨ä½¿ç”¨æ—¶åº”åŒ…å«è¯¥å…¥å‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@State</span><span class="token punctuation">(</span><span class="token class-name">Scope<span class="token punctuation">.</span>Benchmark</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">BenchmarkState</span> <span class="token punctuation">{</span>
        <span class="token keyword">volatile</span> <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">measureShared</span><span class="token punctuation">(</span><span class="token class-name">BenchmarkState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span>x<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="setupåŠ-teardown"><a href="#setupåŠ-teardown" class="header-anchor">#</a> @SetupåŠ@TearDown</h3> <p><code>@Setup</code>: ç”¨äºåŸºå‡†æµ‹è¯•æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œé€šå¸¸ç”¨äºèµ„æºçš„åˆå§‹åŒ–</p> <p><code>@TearDown</code>: ç”¨äºåŸºå‡†æµ‹è¯•æ–¹æ³•ä¹‹åè°ƒç”¨ï¼Œé€šå¸¸ç”¨äºèµ„æºçš„å›æ”¶æ¸…ç†å·¥ä½œ</p> <p>ä¸¤è€…éƒ½å¯ä»¥ä½¿ç”¨<code>Level</code>æ§åˆ¶</p> <p><code>Level</code>: ä½¿ç”¨@Setupå’Œ@TearDownæ—¶ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ@Setupå’Œ@TearDownä¼šåœ¨ä¸€ä¸ªåŸºå‡†æ–¹æ³•çš„æ‰€æœ‰æ‰¹æ¬¡æ‰§è¡Œå‰ååˆ†åˆ«æ‰§è¡Œï¼Œå¦‚æœéœ€è¦åœ¨æ¯ä¸€ä¸ªæ‰¹æ¬¡æˆ–è€…æ¯ä¸€æ¬¡åŸºå‡†æ–¹æ³•è°ƒç”¨æ‰§è¡Œçš„å‰åæ‰§è¡Œå¯¹åº”çš„å¥—ä»¶æ–¹æ³•ï¼Œåˆ™å¯é€šè¿‡Levelæ§åˆ¶</p> <ul><li><code>Trial</code>: è¯•éªŒçº§åˆ«ã€‚Setupå’ŒTearDowné»˜è®¤çš„é…ç½®ï¼Œåœ¨æ¯æ¬¡åŸºå‡†æµ‹è¯•è¿è¡Œä¹‹å‰/ä¹‹åæ‰§è¡Œ</li> <li><code>Iteration</code>: è¿­ä»£çº§åˆ«ã€‚åœ¨åŸºå‡†æµ‹è¯•çš„æ¯æ¬¡è¿­ä»£ä¹‹å‰/ä¹‹åæ‰§è¡Œ</li> <li><code>Invocation</code>: è°ƒç”¨çº§åˆ«ã€‚ä¸ºæ¯ä¸ªåŸºå‡†æµ‹è¯•æ–¹æ³•æ‰§è¡Œ</li></ul> <p>å•ç‹¬ä½¿ç”¨</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Setup</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@TearDown</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">tearDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">assert</span> <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token string">&quot;The Size  Of List Must Lager Than Zero&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testRight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;Test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testWrong</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>é’ˆå¯¹testRightå’ŒtestWrongè¿›è¡Œæµ‹è¯•ï¼ŒtestRightèƒ½å¤Ÿæ­£ç¡®é€šè¿‡ï¼Œå› ä¸ºlistå†…éƒ¨æœ‰å€¼ï¼Œåç½®çš„TearDownä¸ä¼šè¢«æ–­è¨€æ‹¦æˆªã€‚testWrongä¼šè¢«æ–­è¨€æ‹¦æˆªï¼Œå¯¼è‡´Benchmarkç»ˆæ­¢ã€‚</p> <p>å’Œ<code>@State</code>æ··åˆä½¿ç”¨ï¼Œç»„åˆæ–¹å¼ä¸é™äºä»¥ä¸‹ä¸€ç§</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@State</span><span class="token punctuation">(</span><span class="token class-name">Scope<span class="token punctuation">.</span>Benchmark</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">BenchmarkState</span> <span class="token punctuation">{</span>
        <span class="token keyword">double</span> x<span class="token punctuation">;</span>
        <span class="token annotation punctuation">@Setup</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            x <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">measureShared</span><span class="token punctuation">(</span><span class="token class-name">BenchmarkState</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        state<span class="token punctuation">.</span>x<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="warmup"><a href="#warmup" class="header-anchor">#</a> @Warmup</h3> <p>é¢„çƒ­æ‰€éœ€è¦é…ç½®çš„ä¸€äº›åŸºæœ¬æµ‹è¯•å‚æ•°ï¼Œå¯ç”¨äºç±»æˆ–è€…æ–¹æ³•ä¸Šã€‚æ”¾åœ¨Benchmarkæ–¹æ³•ä¸Šï¼Œåªå¯¹è¯¥æ–¹æ³•èµ·ä½œç”¨ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨å¤–å›´ç±»å®ä¾‹ä¸Šï¼Œå¯¹è¯¥ç±»ä¸­çš„æ‰€æœ‰Benchmarkæ–¹æ³•èµ·ä½œç”¨ã€‚ä¸€èˆ¬å‰å‡ æ¬¡è¿›è¡Œç¨‹åºæµ‹è¯•çš„æ—¶å€™ä¼šé‡åˆ°å†·å¯åŠ¨é—®é¢˜ï¼Œå¯¼è‡´ç¨‹åºå¾ˆæ…¢ï¼Œä½¿ç”¨@Warmupï¼Œå¯ä»¥å°†JITè¿›è¡Œæå‰é¢„çƒ­è§£å†³å†·å¯åŠ¨é—®é¢˜ï¼Œå› ä¸º JVM çš„ JIT æœºåˆ¶çš„å­˜åœ¨ï¼Œå¦‚æœæŸä¸ªå‡½æ•°è¢«è°ƒç”¨å¤šæ¬¡ä¹‹åï¼ŒJVM ä¼šå°è¯•å°†å…¶ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œä»è€Œæé«˜æ‰§è¡Œé€Ÿåº¦ï¼Œæ‰€ä»¥ä¸ºäº†è®© Benchmark çš„ç»“æœæ›´åŠ æ¥è¿‘çœŸå®æƒ…å†µå°±éœ€è¦è¿›è¡Œé¢„çƒ­ã€‚</p> <ol><li><code>iterations</code>ï¼šé¢„çƒ­çš„æ¬¡æ•°</li> <li><code>time</code>ï¼šæ¯æ¬¡é¢„çƒ­çš„æ—¶é—´</li> <li><code>timeUnit</code>ï¼šæ—¶é—´çš„å•ä½ï¼Œé»˜è®¤ç§’</li> <li><code>batchSize</code>ï¼šæ‰¹å¤„ç†å¤§å°ï¼Œæ¯æ¬¡æ“ä½œè°ƒç”¨å‡ æ¬¡æ–¹æ³•</li></ol> <h3 id="measurement"><a href="#measurement" class="header-anchor">#</a> @Measurement</h3> <p>å®é™…è°ƒç”¨æ–¹æ³•æ‰€éœ€è¦é…ç½®çš„ä¸€äº›åŸºæœ¬æµ‹è¯•å‚æ•°ï¼Œå¯ç”¨äºç±»æˆ–è€…æ–¹æ³•ä¸Šï¼Œå‚æ•°å’Œ @Warmupç›¸åŒã€‚</p> <p>æ¯”å¦‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Measurement</span><span class="token punctuation">(</span>iterations <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> time <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¡¨ç¤ºä¸ºè¿­ä»£10æ¬¡ï¼Œæ¯æ¬¡5sã€‚å¯ç”¨äºæ§åˆ¶å‹æµ‹æ—¶é—´ã€‚</p> <h3 id="param"><a href="#param" class="header-anchor">#</a> @Param</h3> <p>æŒ‡å®šæŸé¡¹å‚æ•°çš„å¤šç§æƒ…å†µï¼Œé€‚åˆç”¨æ¥æµ‹è¯•ä¸€ä¸ªå‡½æ•°åœ¨ä¸åŒçš„å‚æ•°è¾“å…¥çš„æƒ…å†µä¸‹çš„æ€§èƒ½ï¼Œåªèƒ½ä½œç”¨åœ¨å­—æ®µä¸Šï¼Œä½¿ç”¨è¯¥æ³¨è§£å¿…é¡»å®šä¹‰@Stateæ³¨è§£ã€‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;31&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;65&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;101&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;103&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> arg<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;16&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;32&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> certainty<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BigInteger</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isProbablePrime</span><span class="token punctuation">(</span>certainty<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ä¸Šè¿°ä»£ç çš„å«ä¹‰ä¸ºå¯¹äºargæ•°ç»„ä¸­çš„æ¯ä¸ªæ•°ï¼Œæµ‹è¯•æ˜¯å¦æ˜¯certaintyæ•°ç»„å†…ä»¥ä¸‹çš„ç´ æ•°ï¼Œå‹æµ‹è®¡ç®—æ—¶é—´ï¼Œæ€»è®¡æ‰§è¡Œæ¬¡æ•°ä¸ºargçš„æ•°ç»„é•¿åº¦<code>x</code>certaintyçš„æ•°ç»„é•¿åº¦=35æ¬¡</p> <p>å†çœ‹ä¸€ä¸ªä¾‹å­</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;31&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;65&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;101&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;103&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> arg<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ä¸Šè¿°ä»£ç ä¸ºä¾æ¬¡æ‰§è¡Œargæ•°ç»„ä¸­æ•°æ®ï¼Œè½¬æ¢åˆ°Stringç±»å‹çš„è€—æ—¶</p> <h3 id="threads"><a href="#threads" class="header-anchor">#</a> @Threads</h3> <p>æ¯ä¸ªè¿›ç¨‹ä¸­çš„æµ‹è¯•çº¿ç¨‹ï¼Œå¯ç”¨äºç±»æˆ–è€…æ–¹æ³•ä¸Šã€‚</p> <h3 id="fork"><a href="#fork" class="header-anchor">#</a> @Fork</h3> <p>è¿›è¡ŒForkçš„æ¬¡æ•°ï¼Œå¯ç”¨äºç±»æˆ–è€…æ–¹æ³•ä¸Šã€‚å¦‚æœForkæ•°æ˜¯2çš„è¯ï¼Œåˆ™JMHä¼šForkå‡ºä¸¤ä¸ªè¿›ç¨‹æ¥è¿›è¡Œæµ‹è¯•ã€‚æ¨¡æ‹Ÿå¤šè¿›ç¨‹ç¯å¢ƒï¼Œå®Œå…¨éš”ç¦»å¤šä¸ªè¿›ç¨‹ï¼Œä¸ä¼šç›¸äº’å½±å“ã€‚</p> <h3 id="outputtimeunit"><a href="#outputtimeunit" class="header-anchor">#</a> @OutputTimeUnit</h3> <p>ä¸ºç»Ÿè®¡ç»“æœçš„æ—¶é—´å•ä½ï¼Œå¯ç”¨äºç±»æˆ–è€…æ–¹æ³•æ³¨è§£ï¼Œå•ä½ä¸ºTimeUnitç±»ï¼Œæ”¯æŒåˆ°çº³ç§’çº§ã€‚</p> <h2 id="å¿«é€Ÿä¸Šæ‰‹"><a href="#å¿«é€Ÿä¸Šæ‰‹" class="header-anchor">#</a> å¿«é€Ÿä¸Šæ‰‹</h2> <p>ä»¥ä¸€ä¸ªå…¨é¢çš„ä¾‹å­æ¥è¿›è¡Œè§£é‡Š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Fork</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// Fork 1ä¸ªè¿›ç¨‹è¿›è¡Œæµ‹è¯•</span>
<span class="token annotation punctuation">@BenchmarkMode</span><span class="token punctuation">(</span><span class="token class-name">Mode<span class="token punctuation">.</span>Throughput</span><span class="token punctuation">)</span> <span class="token comment">// ååé‡</span>
<span class="token annotation punctuation">@Warmup</span><span class="token punctuation">(</span>iterations <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// JITé¢„çƒ­</span>
<span class="token annotation punctuation">@Measurement</span><span class="token punctuation">(</span>iterations <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> time <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// è¿­ä»£10æ¬¡,æ¯æ¬¡5s</span>
<span class="token annotation punctuation">@OutputTimeUnit</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MILLISECONDS</span><span class="token punctuation">)</span> <span class="token comment">// ç»“æœæ‰€ä½¿ç”¨çš„æ—¶é—´å•ä½</span>
<span class="token annotation punctuation">@Threads</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// çº¿ç¨‹10ä¸ª</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BenchmarkTestSimple</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * ä½œç”¨åŸŸä¸ºæœ¬æ¬¡JMHæµ‹è¯•ï¼Œçº¿ç¨‹å…±äº«
     * &lt;p&gt;
     * åˆå§‹åŒ–sourceæ•°æ®é›†
     */</span>
    <span class="token annotation punctuation">@State</span><span class="token punctuation">(</span><span class="token class-name">Scope<span class="token punctuation">.</span>Benchmark</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">GenerateModel</span> <span class="token punctuation">{</span>
        <span class="token class-name">DataBaseDO</span> dataBaseModel<span class="token punctuation">;</span>

        <span class="token comment">// åˆå§‹åŒ–</span>
        <span class="token annotation punctuation">@Setup</span><span class="token punctuation">(</span><span class="token class-name">Level<span class="token punctuation">.</span>Trial</span><span class="token punctuation">)</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            dataBaseModel <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ModelService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * åˆå§‹åŒ–MapStruct
     */</span>
    <span class="token annotation punctuation">@State</span><span class="token punctuation">(</span><span class="token class-name">Scope<span class="token punctuation">.</span>Benchmark</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MapStructInit</span> <span class="token punctuation">{</span>
        <span class="token class-name">MapStructMapper</span> mapStructMapper<span class="token punctuation">;</span>

        <span class="token annotation punctuation">@Setup</span><span class="token punctuation">(</span><span class="token class-name">Level<span class="token punctuation">.</span>Trial</span><span class="token punctuation">)</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mapStructMapper <span class="token operator">=</span> <span class="token class-name">Mappers</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">MapStructMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * get/set åŸºå‡†æµ‹è¯•
     *
     * @param generateModel source
     * @return target       DataBaseVO
     * @throws Exception    Exception
     */</span>
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token class-name">DataBaseVO</span> <span class="token function">testGetSet</span><span class="token punctuation">(</span><span class="token class-name">GenerateModel</span> generateModel<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">DataBaseVO</span> dataBaseVO <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataBaseVO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataBaseDO</span> dataBaseModel <span class="token operator">=</span> generateModel<span class="token punctuation">.</span>dataBaseModel<span class="token punctuation">;</span>
        dataBaseVO<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span>dataBaseModel<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataBaseVO<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>dataBaseModel<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataBaseVO<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>dataBaseModel<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataBaseVO<span class="token punctuation">.</span><span class="token function">setYear</span><span class="token punctuation">(</span>dataBaseModel<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataBaseVO<span class="token punctuation">.</span><span class="token function">setOtherTime</span><span class="token punctuation">(</span>dataBaseModel<span class="token punctuation">.</span><span class="token function">getOtherTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataBaseVO<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * MapStructåŸºå‡†æµ‹è¯•
     *
     * @param generateModel source
     * @param init          åˆå§‹åŒ–çš„mapper
     * @return target       DataBaseVO
     * @throws Exception    Exception
     */</span>
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token class-name">DataBaseVO</span> <span class="token function">testMapStruct</span><span class="token punctuation">(</span><span class="token class-name">GenerateModel</span> generateModel<span class="token punctuation">,</span> <span class="token class-name">MapStructInit</span> init<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">DataBaseVO</span> dataBaseVO <span class="token operator">=</span> init<span class="token punctuation">.</span>mapStructMapper<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>generateModel<span class="token punctuation">.</span>dataBaseModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataBaseVO<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><p>ä¸Šè¿°ä»£ç çš„å«ä¹‰ä¸ºï¼š</p> <p>Forkä¸€ä¸ªè¿›ç¨‹è¿›è¡Œæµ‹è¯•ï¼Œåˆ©ç”¨ååé‡ä½œä¸ºè¡¡é‡æŒ‡æ ‡ï¼Œé¢„çƒ­3è½®å†è¿›è¡Œæµ‹è¯•ï¼Œå¯¹æ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿­ä»£10æ¬¡ã€æ¯æ¬¡5ç§’ï¼Œç»“æœé‡‡ç”¨å¾®ç§’ä½œä¸ºå•ä½ï¼Œå¹¶é‡‡ç”¨10ä¸ªçº¿ç¨‹è¿›è¡Œå‘å‹ã€‚åŒæ—¶å¯¹MapStructå’Œæºæ•°æ®è¿›è¡Œåˆå§‹åŒ–ï¼Œæ¶ˆé™¤åˆå§‹åŒ–å¼€é”€ï¼Œè¯„ä¼°MapStructå’ŒåŸç”Ÿget/setçš„æ€§èƒ½å·®å¼‚ã€‚</p> <h2 id="jmh-é¿å…æ­»ä»£ç æ¶ˆé™¤é™·é˜±"><a href="#jmh-é¿å…æ­»ä»£ç æ¶ˆé™¤é™·é˜±" class="header-anchor">#</a> JMH-é¿å…æ­»ä»£ç æ¶ˆé™¤é™·é˜±</h2> <blockquote><p>The downfall of many benchmarks is Dead-Code Elimination (DCE): compilers</p> <p>are smart enough to deduce some computations are redundant and eliminate</p> <p>them completely. If the eliminated part was our benchmarked code, we are</p> <p>in trouble.</p> <p>Fortunately, JMH provides the essential infrastructure to fight this</p> <p>where appropriate: returning the result of the computation will ask JMH</p> <p>to deal with the result to limit dead-code elimination (returned results</p> <p>are implicitly consumed by Blackholes, see JMHSample_09_Blackholes).</p></blockquote> <p>å¼•ç”¨å®˜æ–¹çš„è§£é‡Š: è®¸å¤šåŸºå‡†æµ‹è¯•çš„å¤±è´¥æ˜¯å› ä¸ºæ­»ä»£ç æ¶ˆé™¤(DCE)ï¼Œå› ä¸ºç¼–è¯‘å™¨è¶³å¤Ÿèªæ˜ï¼Œå¯ä»¥æ¨æ–­å‡ºä¸€äº›è®¡ç®—æ˜¯å†—ä½™çš„å¹¶å®Œå…¨æ¶ˆé™¤æ‰ä»–ä»¬ï¼Œå¦‚æœè¢«æ·˜æ±°çš„éƒ¨åˆ†æ˜¯åŸºå‡†æµ‹è¯•çš„ä»£ç ï¼Œé‚£å°†å¼•èµ·åŸºå‡†æµ‹è¯•çš„å¤±è´¥(ä¸å‡†ç¡®)</p> <p>æ­»ä»£ç é™·é˜±çš„ä¸€ä¸ªå…¸å‹åœºæ™¯å¦‚ä¸‹</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JMHSample</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">private</span> <span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Benchmark</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">measureWrong</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// This is wrong: result is not used and the entire computation is optimized away.</span>
        <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ä¸Šè¿°ä»£ç é‡‡ç”¨voidè¿›è¡Œè¿”å›ï¼Œä½¿å¾—å˜é‡<code>x</code>çš„ç»“æœå¹¶æ²¡æœ‰è¢«ç”¨åˆ°ï¼ŒJVMä¼˜åŒ–æ—¶ä¼šå°†æ•´ä¸ªæ–¹æ³•çš„å†…éƒ¨ä»£ç ç§»é™¤ã€‚</p> <p>JMHæä¾›äº†2ç§æ–¹å¼é¿å…è¯¥é—®é¢˜:</p> <ol><li>å°†å˜é‡ä½œä¸ºæ–¹æ³•çš„è¿”å›å€¼ï¼Œå³æ­¤æ—¶æ–¹æ³•è¿”å›<code>double</code>ï¼Œ<code>return Math.log(x)</code></li> <li>é€šè¿‡JMHçš„<code>Blackhole consume</code>é¿å…JITä¼˜åŒ–æ¶ˆé™¤</li></ol> <p>é€šè¿‡JMHæ’ä»¶åˆ›å»ºçš„Benchmarkè‡ªå¸¦è¯¥å…¥å‚</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Benchmark</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">measureName</span><span class="token punctuation">(</span><span class="token class-name">Blackhole</span> bh<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    bh<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>xxxxx<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>JMHçš„å…¶ä»–æ­»ä»£ç é™·é˜±è¿˜æœ‰å¸¸é‡æŠ˜å ã€å¸¸é‡ä¼ æ’­ã€æ°¸è¿œä¸è¦åœ¨æµ‹è¯•ä¸­å†™å¾ªç¯ã€ä½¿ç”¨ Fork éš”ç¦»å¤šä¸ªæµ‹è¯•æ–¹æ³•ã€æ–¹æ³•å†…è”ã€ä¼ªå…±äº«ä¸ç¼“å­˜è¡Œã€åˆ†æ”¯é¢„æµ‹ã€å¤šçº¿ç¨‹æµ‹è¯•ç­‰ï¼Œå¯å‚è€ƒJMHä¸“å®¶Aleksey Shipilevçš„JMHå…¬å¼€è¯¾<a href="https://www.youtube.com/watch?v=VaWgOCDBxYw" target="_blank" rel="noopener noreferrer">Benchmarking (&quot;The Lesser of Two Evils&quot; Story)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="jmhå¯è§†åŒ–"><a href="#jmhå¯è§†åŒ–" class="header-anchor">#</a> JMHå¯è§†åŒ–</h2> <p>JMHæ‰“å°çš„ç»“æœä¸ºæ–‡å­—å‹ï¼Œè¿è¡Œæ—¶å¯ä»¥æŒ‡å®šä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä¸ºäº†æ›´ç›´è§‚çš„è§‚å¯Ÿç»“æœï¼Œå¯ä»¥å°è¯•ä½¿ç”¨JMHå¯è§†åŒ–ç½‘ç«™</p> <ol><li><a href="http://deepoove.com/jmh-visual-chart/" target="_blank" rel="noopener noreferrer">http://deepoove.com/jmh-visual-chart/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://jmh.morethan.io/" target="_blank" rel="noopener noreferrer">https://jmh.morethan.io/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="header-anchor">#</a> å‚è€ƒæ–‡ç« </h2> <p>[1]. <a href="https://hg.openjdk.java.net/code-tools/jmh/file/tip/jmh-samples/src/main/java/org/openjdk/jmh/samples/" target="_blank" rel="noopener noreferrer">https://hg.openjdk.java.net/code-tools/jmh/file/tip/jmh-samples/src/main/java/org/openjdk/jmh/samples/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[2]. <a href="https://jmeter.apache.org/" target="_blank" rel="noopener noreferrer">https://jmeter.apache.org/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[3]. <a href="https://github.com/wg/wrk" target="_blank" rel="noopener noreferrer">https://github.com/wg/wrk<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[4]. <a href="https://cloud.tencent.com/developer/article/1896652" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1896652<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[5]. <a href="http://shipilev.net/" target="_blank" rel="noopener noreferrer">http://shipilev.net/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[6]. <a href="https://www.youtube.com/watch?v=VaWgOCDBxYw" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=VaWgOCDBxYw<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/benym/benym-book/edit/master/docs/01.Java/01.Java/04.Java-JVM/02.JMH-åŸºå‡†æµ‹è¯•æ¡†æ¶.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=Java" title="æ ‡ç­¾">#Java</a><a href="/tags/?tag=JVM" title="æ ‡ç­¾">#JVM</a><a href="/tags/?tag=JMH" title="æ ‡ç­¾">#JMH</a><a href="/tags/?tag=BenchMark" title="æ ‡ç­¾">#BenchMark</a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2022/12/30, 20:16:31</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/0a146e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">è‡ªå®šä¹‰ç±»åŠ è½½å™¨</div></a> <a href="/pages/4aef64/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">æ¦‚è§ˆ</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/0a146e/" class="prev">è‡ªå®šä¹‰ç±»åŠ è½½å™¨</a></span> <span class="next"><a href="/pages/4aef64/">æ¦‚è§ˆ</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/1c47ed/"><div>
            ä¼˜é›…çš„å‚æ•°æ ¡éªŒä¸å…¨å±€å¼‚å¸¸-ä»£ç è§„èŒƒçš„å¤©ç”Ÿè½åœ°
            <!----></div></a> <span class="date">02-01</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/b127c7/"><div>
            MethodHandleç»“åˆLambdaMetafactory-ä½¿ç”¨æ–¹æ³•åŠæ€§èƒ½æµ‹è¯•
            <!----></div></a> <span class="date">12-27</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/cedee6/"><div>
            Beanå·¥å…·ç±»-RpasBeanUtils
            <!----></div></a> <span class="date">11-25</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:675260709@qq.com" title="é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/benym" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://www.zhihu.com/people/xu-ge-yuan-ba-68" title="çŸ¥ä¹" target="_blank" class="iconfont icon-zhihu"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2018-2023
    <span>benym | <a href="https://github.com/benym/benym-book/blob/master/LICENSE" target="_blank">MIT License</a> | <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">æ¸ICPå¤‡18012574å·</a></span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.7da65b61.js" defer></script><script src="/assets/js/2.97c812e5.js" defer></script><script src="/assets/js/18.4a6b0db1.js" defer></script><script src="/assets/js/6.d98d2c99.js" defer></script>
  </body>
</html>
