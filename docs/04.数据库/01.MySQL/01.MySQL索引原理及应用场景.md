---
title: MySQLç´¢å¼•åŽŸç†åŠåº”ç”¨åœºæ™¯
description: MySQLç´¢å¼•æ€»ç»“
categories: 
  - MySQL
tags: 
  - MySQL
  - ç´¢å¼•
  - B+æ ‘
keywords: MySQL,ç´¢å¼•,B+æ ‘
date: 2022-08-02 18:56:07
permalink: /pages/0f7e8e/
---

## ä»€ä¹ˆæ˜¯ç´¢å¼•

åœ¨å·¥ä½œå½“ä¸­ï¼Œæ¶‰åŠåˆ°MySQLçš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ç»™æŸä¸ªè¡¨æŸä¸ªå­—æ®µåŠ ç´¢å¼•çš„è¯‰æ±‚ï¼ŒåŠ ä¸Šç´¢å¼•èƒ½å¤Ÿè®©æˆ‘ä»¬çš„sqlå¾—åˆ°æŸ¥è¯¢é€Ÿåº¦ä¸Šçš„æå‡ã€‚ä½†ç´¢å¼•çš„åŽŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Œä»–åˆæ˜¯æ€Žä¹ˆå·¥ä½œçš„ï¼Œéœ€è¦å¼€å‘è€…å¯¹åŸºç¡€çŸ¥è¯†æœ‰ä¸€å®šçš„äº†è§£ã€‚

## ç´¢å¼•åˆ†ç±»

ç´¢å¼•é€šè¿‡ç‰¹å®šçš„ä¸€äº›æ•°æ®ç»“æž„ï¼Œå°†æ•°æ®ç»„ç»‡æœ‰åºï¼Œå°†éšæœºI/Oå˜ä¸ºé¡ºåºI/Oï¼Œæœ‰æ•ˆå‡å°‘æŸ¥è¯¢ä¸€æ¡æ•°æ®æ‰€éœ€è¦æ‰«æçš„æ•°æ®é‡ï¼ŒåŠ å¿«æŸ¥è¯¢çš„é€Ÿåº¦ã€‚

ä»Žä½¿ç”¨è€…çš„è§’åº¦è€Œè¨€ï¼ŒMySQLç´¢å¼•ä¸»è¦ä¸ºä»¥ä¸‹å‡ ç§ã€‚

**ä¸»é”®ç´¢å¼•**

æ ¹æ®æ•°æ®è¡¨ä¸»é”®å»ºç«‹çš„ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤å’Œç©ºå€¼ã€‚ä¸»é”®ç´¢å¼•åˆ—å…¨è¡¨å”¯ä¸€

```sql
alter table 'table_name' add primary key pk_index_name('col_name');
```

**å”¯ä¸€ç´¢å¼•**

ç”¨äºŽç¡®ä¿å»ºç«‹ç´¢å¼•åˆ—å†…çš„å€¼æ˜¯å”¯ä¸€çš„ï¼Œå…è®¸ç©ºå€¼ã€‚æ¯”å¦‚åŒæ ·ä¸ºageå­—æ®µï¼Œä¸èƒ½å‡ºçŽ°2ä¸ªageä¸º10çš„æ•°æ®

```sql
alter table 'table_name' add unique unique_index_name('col_name');
```

**æ™®é€šç´¢å¼•**

ç”¨äºŽè¡¨ä¸­çš„æ™®é€šåˆ—æž„å»ºçš„ç´¢å¼•ï¼Œæ²¡æœ‰ç‰¹æ®Šé™åˆ¶

```sql
alter table 'table_name' add index index_name('col_name');
```

**è”åˆç´¢å¼•**

é‡‡ç”¨å¤šä¸ªåˆ—ç»„åˆæž„å»ºçš„ç´¢å¼•ï¼Œç”¨äºŽç»„åˆæœç´¢

```sql
alter table 'table_name' add index index_name('col1_name','col2_name');
```

**å…¨æ–‡ç´¢å¼•**

ç”¨äºŽå¤§æ–‡æœ¬å¯¹è±¡çš„åˆ—æž„å»ºç´¢å¼•

```sql
alter table 'table_name' add fulltext index full_index_name('col_name');
```

**ç©ºé—´ç´¢å¼•**

ç”¨äºŽGISåœ°å›¾æ•°æ®çš„ç´¢å¼•ï¼ŒMySQLä¸­çš„ç©ºé—´æ•°æ®ç±»åž‹æœ‰GEOMETRYã€POINTã€LINESTRINGã€POLYGON

```sql
alter table 'table_name' add spatial index spa_index_name('col_name');
```

## ç´¢å¼•æ•°æ®ç»“æž„

æ ¹æ®æ•°æ®ç»“æž„çš„ä¸åŒï¼ŒMySQLçš„ç´¢å¼•å¯åˆ†ä¸º`å“ˆå¸Œç´¢å¼•`ã€`BTreeç´¢å¼•`ã€`B+Treeç´¢å¼•`ã€‚

**å“ˆå¸Œç´¢å¼•**

å“ˆå¸Œç´¢å¼•é€šè¿‡hashè¡¨å®žçŽ°ï¼Œé€šè¿‡å°†hashå‡½æ•°è®¡ç®—å‡ºçš„hashå€¼å­˜å‚¨åœ¨ç´¢å¼•ä¸­ï¼Œæ¥å®Œæˆkey-valueçš„å¿«é€ŸæŸ¥è¯¢

![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-hash.png)

é€šå¸¸è€Œè¨€å½“å‘ç”Ÿhashç¢°æ’žä¹‹åŽ(å³ä¸¤ä¸ªkeyåœ¨ç»è¿‡hashå‡½æ•°ä¹‹åŽå€¼ä¸ºåŒä¸€ä¸ª)ï¼Œé‡‡ç”¨é“¾åœ°å€æ³•è§£å†³å†²çªï¼Œå¦‚ä¸Šå›¾ä¸­å°åˆ˜åˆ°å°çŽ‹çš„è¿žæŽ¥çº¿ï¼ŒèŽ·å–keyæ‰¾åˆ°ç´¢å¼•åœ°å€ä¹‹åŽï¼Œé¡ºåºéåŽ†åœ°å€å†…çš„é“¾è¡¨ï¼ŒèŽ·å¾—æœ€ç»ˆç»“æžœã€‚

å“ˆå¸Œç´¢å¼•çš„ç‰¹ç‚¹å’Œhashmapç±»ä¼¼ï¼Œé€‚åˆäºŽç²¾ç¡®æŸ¥æ‰¾ï¼Œä½†ä¸é€‚åˆèŒƒå›´æŸ¥æ‰¾ï¼Œhashç å¹¶ä¸å…·æœ‰è§„å¾‹æ€§ï¼Œæ‰€ä»¥å­˜å‚¨hashç´¢å¼•æ—¶é¡ºåºæ€§æ˜¯æ— æ³•ä¿éšœçš„ã€‚

**BTreeç´¢å¼•**

å…³äºŽå¹³è¡¡äºŒå‰æœç´¢æ ‘çš„æ¦‚å¿µå’Œæ„ä¹‰å¯ä»¥è¯¦è§æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ðŸ‘‰[äºŒå‰æœç´¢æ ‘åŠAVLæ ‘è¯¦è§£](https://cloud.benym.cn/benym-book/pages/2efaaf/)ã€‚

Bæ ‘å®žé™…ä¸Šæ˜¯ä¸€æ£µå¤šå‰å¹³è¡¡æœç´¢æ ‘ã€‚å…¶å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹

::: note

æ ¹èŠ‚ç‚¹å·¦ä¾§æ•°å€¼å°äºŽæ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹å³ä¾§æ•°å€¼å¤§äºŽæ ¹èŠ‚ç‚¹

æ¯ä¸ªå¶å­èŠ‚ç‚¹é«˜åº¦ä¸€è‡´

æŒ‡é’ˆpå­˜å‚¨èŠ‚ç‚¹çš„åœ°å€ä¿¡æ¯

éžå¶å­èŠ‚ç‚¹ä¸º[key,data]äºŒå…ƒç»„ï¼Œå…¶ä¸­keyè¡¨ç¤ºä½œä¸ºç´¢å¼•çš„é”®ï¼Œdataä¸ºkeyå€¼æ‰€åœ¨è¡Œçš„æ•°æ®

:::

Bæ ‘çš„ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤º

![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-btree.png)

åœ¨Bæ ‘çš„ç»“æž„å›¾ä¸­ï¼Œå¯ä»¥å‘çŽ°æ¯ä¸ªèŠ‚ç‚¹ä¸ä»…ä»…åŒ…å«æ•°æ®çš„Keyå€¼ï¼Œè¿˜æœ‰dataå€¼ã€‚

è€Œæ¯é¡µçš„å­˜å‚¨ç©ºé—´æ˜¯æœ‰é™çš„ï¼Œå¦‚æžœdataæ¯”è¾ƒå¤§ï¼Œä¼šå¯¼è‡´æ¯ä¸ªèŠ‚ç‚¹çš„Keyå­˜å‚¨è¾ƒå°‘ã€‚

å½“æ•°æ®é‡æ‰©å¤§æ—¶ï¼ŒBæ ‘åªèƒ½å¾€ä¸‹è¿›è¡Œåˆ†è£‚ï¼Œå¯¼è‡´æ ‘æ·±çš„å¢žé«˜ï¼Œå¢žåŠ äº†ç£ç›˜I/Oçš„æ¬¡æ•°ï¼Œå½±å“æŸ¥è¯¢æ•ˆçŽ‡ã€‚

**B+Treeç´¢å¼•**

ä¸ºäº†è§£å†³Bæ ‘çš„æ•ˆçŽ‡é—®é¢˜ï¼ŒB+æ ‘åšäº†å¦‚ä¸‹æ”¹è¿›

::: note

éžå¶å­èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼ä¿¡æ¯ï¼Œä¸å†å­˜å‚¨æ•°æ®

æ‰€æœ‰å¶å­èŠ‚ç‚¹ä¹‹é—´éƒ½æœ‰ä¸€ä¸ªé“¾æŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå¶å­èŠ‚ç‚¹

æ•°æ®éƒ½å­˜æ”¾åœ¨å¶å­èŠ‚ç‚¹ä¸­

:::

B+æ ‘çš„ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤º

![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-b%2Btree.png)

ä¸ºäº†æ›´è¯¦ç»†çš„æè¿°B+æ ‘ï¼Œå›¾ä¸­çš„æŒ‡é’ˆå†™æ˜Žäº†å­˜å‚¨çš„ç£ç›˜å—åç§°ï¼Œæœ€åº•ä¸‹ä¸€å±‚å«æœ‰æ•°æ®çš„ç£ç›˜å—è¢«ç§°ä¸º**æ•°æ®é¡µ**ï¼Œæ•°æ®é¡µä¹‹é—´é€šè¿‡åŒå‘é“¾è¡¨è¿›è¡Œè¿žæŽ¥ï¼Œéžå¶å­èŠ‚ç‚¹çš„ç£ç›˜å—è¢«ç§°ä¸º**ç´¢å¼•é¡µ**

å°†ä¸Šå›¾ä¸­ç£ç›˜å—2ä¸Žç£ç›˜å—5ã€6ã€7æ‹¿å‡ºæ¥è¿›è¡Œç»†åˆ†ï¼Œæˆ‘ä»¬å±•å¼€å„ç£ç›˜å—ï¼ŒæŸ¥çœ‹å•ä¸ªç£ç›˜å—å†…æ•°æ®çš„æŽ’åˆ—æ–¹å¼

![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-b%2Btree-data.png)

MySQLåœ¨å­˜å‚¨æ•°æ®æ—¶ä»¥æ•°æ®é¡µä¸ºæœ€å°å•ä½ï¼Œä¸”æ•°æ®åœ¨æ•°æ®é¡µä¸­çš„å­˜å‚¨æ˜¯**è¿žç»­**çš„ï¼Œæ•°æ®é¡µä¸­çš„æ•°æ®æ˜¯æŒ‰ç…§ä¸»é”®æŽ’åº(å¦‚æ²¡æœ‰ä¸»é”®åˆ™ç”±MySQLè‡ªèº«ç»´æŠ¤çš„ROW_IDæŽ’åº)ï¼Œè€Œæ•°æ®é¡µä¸Žæ•°æ®é¡µä¹‹é—´åˆ™é‡‡ç”¨**åŒå‘é“¾è¡¨**å…³è”ï¼Œæ•°æ®ä¸Žæ•°æ®ä¹‹é—´é€šè¿‡**å•å‘é“¾è¡¨**å…³è”ã€‚

åœ¨æ¯ä¸ªæ•°æ®é¡µä¸­ï¼Œå¿…ç„¶å­˜åœ¨æœ€å°ä¸»é”®ï¼Œæ¯ä¸ªæ•°æ®é¡µçš„æœ€å°ä¸»é”®+ç£ç›˜å—åœ°å€ä¼šå½¢æˆä¸€ä¸ªä¸»é”®ç›®å½•ï¼Œå¤šä¸ªä¸»é”®ç›®å½•ä¼šå½¢æˆä¸€ä¸ªç´¢å¼•é¡µ(å¦‚ç£ç›˜å—2ç»“æž„æ‰€ç¤º)ã€‚

::: tip

ç´¢å¼•é¡µçš„å‡ºçŽ°å°±æ˜¯ä¸ºäº†è§£å†³æ•°æ®é¡µè®°å½•è¿‡å¤šï¼Œå¯¼è‡´ä¸»é”®ç›®å½•ç‰¹åˆ«å¤§ï¼Œå½±å“äºŒåˆ†æŸ¥æ‰¾æ•ˆçŽ‡çš„é—®é¢˜ã€‚

ä¸Žæ•°æ®é¡µç±»ä¼¼ï¼Œå¦‚æžœä¸€å¼ æ•°æ®é¡µ/ç´¢å¼•é¡µå­˜å‚¨ç©ºé—´ä¸å¤Ÿï¼Œåˆ™ç»§ç»­åˆ†è£‚åˆ°ä¸‹ä¸€å¼ ï¼Œå³ç»“æž„å›¾ä¸­å±•ç¤ºçš„ç£ç›˜å—1ã€2ã€3ã€4å‡ä¸ºç´¢å¼•é¡µ

:::

**é‚£ä¹ˆç´¢å¼•é¡µå’Œæ•°æ®é¡µåˆ°åº•æ˜¯å¤šå¤§çš„å¤§å°å‘¢**ï¼Ÿ

å¼•ç”¨ä¸€ä¸‹ç½‘ç»œä¸­çš„è§£é‡Š

> è®¡ç®—æœºåœ¨å­˜å‚¨æ•°æ®çš„æ—¶å€™ï¼Œæœ€å°å­˜å‚¨å•å…ƒæ˜¯æ‰‡åŒºï¼Œä¸€ä¸ªæ‰‡åŒºçš„å¤§å°æ˜¯ 512 å­—èŠ‚ï¼Œè€Œæ–‡ä»¶ç³»ç»Ÿï¼ˆä¾‹å¦‚ XFS/EXT4ï¼‰æœ€å°å•å…ƒæ˜¯å—ï¼Œä¸€ä¸ªå—çš„å¤§å°æ˜¯ 4KBã€‚InnoDB å¼•æ“Žå­˜å‚¨æ•°æ®çš„æ—¶å€™ï¼Œæ˜¯ä»¥é¡µä¸ºå•ä½çš„ï¼Œæ¯ä¸ªæ•°æ®é¡µçš„å¤§å°é»˜è®¤æ˜¯ 16KBï¼Œå³å››ä¸ªå—ã€‚

åŸºäºŽè¯¥ç†è®ºï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´ç®—å‡ºB+æ ‘èƒ½å¤Ÿå­˜å‚¨çš„æ•°æ®ã€‚

å‡è®¾æ•°æ®åº“ä¸­ä¸€æ¡è®°å½•æ˜¯`1KB`ï¼Œé‚£ä¹ˆä¸€ä¸ªé¡µå°±å¯ä»¥å­˜`16`æ¡æ•°æ®ï¼ˆå¶å­ç»“ç‚¹ï¼‰ï¼›å¯¹äºŽéžå¶å­ç»“ç‚¹å­˜å‚¨çš„åˆ™æ˜¯é”®å€¼+æŒ‡é’ˆï¼Œåœ¨InnoDBä¸­ï¼Œä¸€ä¸ªæŒ‡é’ˆçš„å¤§å°æ˜¯`6`ä¸ªå­—èŠ‚ï¼Œå‡è®¾æˆ‘ä»¬çš„ä¸»é”®æ˜¯bigint ï¼Œé‚£ä¹ˆä¸»é”®å `8`ä¸ªå­—èŠ‚ï¼Œå¿½ç•¥ä¸€äº›å…¶ä»–çš„å¤´ä¿¡æ¯å¤§å°ï¼Œå¤§è‡´è®¡ç®—å¯ä»¥å¾—åˆ°ï¼š

::: center
`16*1024/(8+6)=1170`
:::

å³ä¸€ä¸ªéžå¶å­èŠ‚ç‚¹å¯ä»¥æŒ‡å‘1170ä¸ªé¡µï¼Œé‚£ä¹ˆä¸€ä¸ªä¸‰å±‚çš„B+æ ‘å¯ä»¥å­˜å‚¨çš„æ•°æ®é‡ä¸ºï¼š

::: center
`1170*1170*16=21902400`
:::

å¤§çº¦2100ä¸‡æ¡æ•°æ®ã€‚

åœ¨InnoDBå­˜å‚¨å¼•æ“Žä¸­ï¼ŒB+æ ‘çš„é«˜åº¦ä¸€èˆ¬ä¸º2-4 å±‚ï¼Œè¿™å°±å¯ä»¥æ»¡è¶³åƒä¸‡çº§çš„æ•°æ®çš„å­˜å‚¨ï¼ŒæŸ¥æ‰¾æ•°æ®çš„æ—¶å€™ï¼Œä¸€æ¬¡é¡µçš„æŸ¥æ‰¾ä»£è¡¨ä¸€æ¬¡I/Oï¼Œé‚£æˆ‘ä»¬é€šè¿‡ä¸»é”®ç´¢å¼•æŸ¥è¯¢çš„æ—¶å€™ï¼Œå…¶å®žæœ€å¤šåªéœ€è¦2-4æ¬¡I/Oæ“ä½œå°±å¯ä»¥äº†ã€‚

## B+Treeçš„æŸ¥è¯¢è¿‡ç¨‹

è¿˜æ˜¯åŸºäºŽB+æ ‘çš„ç»“æž„å›¾

å‡è®¾æˆ‘ä»¬è¦æŸ¥è¯¢`key=16`çš„æ•°æ®ï¼Œé€šè¿‡æœ€é¡¶å±‚ç´¢å¼•é¡µçš„æ¡ä»¶ï¼Œæˆ‘ä»¬çŸ¥é“éœ€è¦ä»Žç£ç›˜å—2çš„ç´¢å¼•é¡µè¿›è¡ŒæŸ¥è¯¢ã€‚

ä¾æ¬¡æ¯”è¾ƒç£ç›˜å—2ä¸­çš„`key`å€¼ï¼Œèƒ½å¤ŸçŸ¥é“`key>=12`çš„æ•°æ®å‡åœ¨`p6`æŒ‡é’ˆæŒ‡å‘çš„ç£ç›˜å—å†…ã€‚

äºŽæ˜¯æˆ‘ä»¬å¯ä»¥å®šä½åˆ°ç£ç›˜å—7å¯¹åº”çš„æ•°æ®é¡µï¼Œé€šè¿‡é¡ºåºéåŽ†æ•°æ®é¡µå†…çš„å•å‘é“¾è¡¨ï¼Œæœ€ç»ˆæ‰¾åˆ°`key=16`å¯¹åº”çš„`data`æ•°æ®è¡Œã€‚

## èšç°‡ç´¢å¼•ä¸Žéžèšç°‡ç´¢å¼•

ä½œä¸ºéžå¸¸é«˜é¢‘çš„çŸ¥è¯†ç‚¹ï¼Œè¿™ä¸¤ç§ç´¢å¼•é€šå¸¸ä¼šæœ‰å¦‚ä¸‹è§£é‡Š

::: note

èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹åº”çš„æ•°æ®æœ¬èº«

éžèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹åº”çš„æ•°æ®çš„ä¸»é”®é”®å€¼

:::

åœ¨Innodbä¸­èšç°‡ç´¢å¼•ä¸€èˆ¬é»˜è®¤ä»¥ä¸»é”®å»ºç«‹ï¼Œä¹Ÿç§°ä¸º**ä¸»é”®ç´¢å¼•**

éžèšç°‡ç´¢å¼•åˆ™ä»¥å…¶ä»–éžä¸»é”®å­—æ®µå»ºç«‹ï¼Œä¹Ÿç§°ä¸º**è¾…åŠ©ç´¢å¼•**

ä»¥ä¸‹åˆ—æ•°æ®è¡¨ä¸ºä¾‹
::: center
![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-table.png)
:::

å¦‚æžœé‡‡ç”¨èšç°‡ç´¢å¼•çš„å­˜å‚¨æ–¹å¼(ä¸»é”®ä¸ºID)ï¼Œåˆ™å¯¹åº”çš„ç´¢å¼•ç»“æž„ä¸º

![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-clus.png)

å¯ä»¥çœ‹å‡º**èšç°‡ç´¢å¼•çš„æ•°æ®å’Œç´¢å¼•å­˜å‚¨åœ¨ä¸€èµ·**ï¼Œæ ¹æ®Idç´¢å¼•èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„æ•°æ®è¡Œï¼Œæ¯”å¦‚`where Id = 7`è¿™æ ·çš„æ¡ä»¶ï¼Œèšç°‡ç´¢å¼•èƒ½å¤ŸæŸ¥åˆ°å¯¹åº”ä¸»é”®ï¼ŒèŽ·å¾—å¯¹åº”çš„å¶å­èŠ‚ç‚¹ä¸Šçš„è¡Œæ•°æ®ã€‚

å¦‚æžœä»¥Nameå­—æ®µå»ºç«‹ç´¢å¼•ï¼Œåˆ™å¯¹åº”çš„è¾…åŠ©ç´¢å¼•ç»“æž„ä¸º

![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-noclus.png)

å¯ä»¥çœ‹å‡º**éžèšç°‡ç´¢å¼•çš„æ•°æ®å’Œç´¢å¼•ï¼Œå¹¶éžå­˜å‚¨åœ¨ä¸€èµ·**ï¼Œæ ¹æ®Nameç´¢å¼•åªèƒ½æ‰¾åˆ°Nameå¯¹åº”çš„ä¸»é”®Idï¼Œæ¯”å¦‚`where Name = å¼ ä¸‰`ï¼Œéžèšç°‡ç´¢å¼•éœ€è¦é€šè¿‡**ä¸¤ä¸ªæ­¥éª¤**æ‰èƒ½èŽ·å–è¡Œæ•°æ®ã€‚

- ç¬¬ä¸€æ­¥ï¼Œåœ¨éžèšç°‡ç´¢å¼•çš„B+æ ‘ä¸­æŸ¥è¯¢å¯¹åº”Nameï¼ŒèŽ·å¾—å¶å­èŠ‚ç‚¹ä¸ŠåŒ¹é…çš„Nameçš„ä¸»é”®ã€‚

- ç¬¬äºŒæ­¥ï¼Œæ ¹æ®åŒ¹é…çš„ä¸»é”®Idåœ¨èšç°‡ç´¢å¼•B+æ ‘ä¸Šå†æ‰§è¡Œä¸€æ¬¡æ£€ç´¢ï¼ŒèŽ·å–å¶å­èŠ‚ç‚¹ä¸Šçš„è¡Œæ•°æ®ã€‚

æ•´ä¸ªè¿‡ç¨‹å¯å¦‚ä¸‹å›¾æ‰€ç¤º

![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-search.png)

ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºŽ**éžèšç°‡ç´¢å¼•ä¼šå¤šä¸€æ¬¡æŸ¥è¯¢èšç°‡ç´¢å¼•çš„è¿‡ç¨‹**

## ç´¢å¼•ä¼˜åŒ–
### å›žè¡¨

**å›žè¡¨æ˜¯ä»€ä¹ˆ**ï¼Ÿ

å‡è®¾æœ‰å¦‚ä¸‹Sqlæ‰§è¡Œ

```sql
select * from student where name = 'å¼ ä¸‰';
```

ç”±äºŽæŸ¥è¯¢é”®ä¸ºnameï¼Œæ‰€ä»¥æŸ¥è¯¢æ—¶èµ°è¾…åŠ©ç´¢å¼•æ ‘ï¼Œå¾ˆå¿«å°±å®šä½åˆ°äº†`Name=å¼ ä¸‰`çš„å¶å­èŠ‚ç‚¹ï¼Œä½†ç”±äºŽæŸ¥è¯¢æ¡ä»¶ä¸º`select *`ï¼Œè¾…åŠ©ç´¢å¼•æ ‘ä¸­å¹¶æ²¡æœ‰åŒ…å«å…¨è¡¨å­—æ®µï¼Œæ‰€ä»¥ä¼šå†æ¬¡æ ¹æ®`Name=å¼ ä¸‰`çš„ä¸»é”®IdæŸ¥è¯¢ä¸»é”®ç´¢å¼•æ ‘ã€‚

è¿™ä¸ªè¿‡ç¨‹å’Œåˆšæ‰éžèšç°‡ç´¢å¼•çš„æŸ¥è¯¢è¿‡ç¨‹ç›¸åŒï¼Œé€šè¿‡è¾…åŠ©ç´¢å¼•æŸ¥è¯¢åˆ°å­—æ®µï¼Œä½†ä»éœ€è¦èµ°ä¸»é”®ç´¢å¼•è¡¥å…¨selectä¿¡æ¯çš„è¿‡ç¨‹ï¼Œå«åš**å›žè¡¨**ã€‚

### ç´¢å¼•è¦†ç›–

ç´¢å¼•è¦†ç›–å°±æ˜¯æ‰§è¡Œçš„sqlæŸ¥è¯¢çš„å­—æ®µåˆšå¥½å¯ä»¥å‘½ä¸­ç´¢å¼•ï¼Œä¸éœ€è¦é¢å¤–å›žè¡¨

ä¾‹å¦‚

```sql
select id from student where id = 123
```

è¿™æ ·çš„æŸ¥è¯¢èƒ½å¤Ÿå‘½ä¸­ç´¢å¼•ï¼Œä¸”ç´¢å¼•å­—æ®µå’ŒæŸ¥è¯¢å­—æ®µåŒ¹é…

è€Œä¾‹å¦‚

```sql
select id, name from student where id = 123
```

è¿™æ ·çš„æŸ¥è¯¢åˆ™ä¼šå›žè¡¨

### è”åˆç´¢å¼•

ä½œä¸ºä¸‹æ–‡çš„åŸºç¡€ï¼Œè¿™é‡Œå…ˆè¯´ä¸€ä¸‹è”åˆç´¢å¼•ã€‚

å‡è®¾çŽ°åœ¨æœ‰å¦‚ä¸‹åœºæ™¯ï¼ŒæŒ‰ç…§å¸‚æ°‘çš„èº«ä»½è¯å·åŽ»æŸ¥è¯¢ä»–çš„å®¶åº­åœ°å€ï¼Œè¿™ä¸ªæŸ¥è¯¢éœ€æ±‚åœ¨ä¸šåŠ¡ä¸­å‡ºçŽ°çš„æ¦‚çŽ‡ä¸é«˜ï¼Œä½†æˆ‘ä»¬ä¹Ÿä¸èƒ½è®©ä»–ç›´æŽ¥èµ°å…¨è¡¨æ‰«æã€‚

å¦‚æžœå•ç‹¬çš„ä¸ºä¸€ä¸ªä¸é¢‘ç¹çš„æŸ¥è¯¢è¯·æ±‚åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œæ„Ÿè§‰åˆæœ‰ç‚¹æµªè´¹èµ„æºï¼Œè¿™æ—¶å€™å°±å¯ä»¥é€šè¿‡å»ºç«‹è”åˆç´¢å¼•ï¼Œå‡å°‘å¼€é”€ã€‚

å‡è®¾ä»¥æ•°æ®åº“çš„`a`å­—æ®µå’Œ`b`å­—æ®µå»ºç«‹è”åˆç´¢å¼•ï¼Œ`a`å’Œ`b`å‡ä¸º`int`ç±»åž‹å­—æ®µ

```sql
alter table 'table_name' add index index_name('a','b');
```

åˆ™ç”Ÿæˆçš„è”åˆç´¢å¼•B+æ ‘ä¼šä»¥è”åˆç´¢å¼•å­—æ®µå…±åŒå»ºç«‹ï¼Œå³è”åˆç´¢å¼•çš„é”®å€¼å¯¹å¤§äºŽ1ä¸ª

::: center
![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-unindex.png)
:::

å°†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹æŒ‰ç…§å­—æ®µæ‹¿å‡ºæ¥è¿›è¡Œåˆ†æžï¼Œä»Žå·¦è‡³å³

açš„é¡ºåºä¸º: 1, 1, 2, 2, 3, 3

bçš„é¡ºåºä¸º: 1, 2, 1, 4, 1, 2

å¤§å®¶å¯ä»¥å‘çŽ°`a`å­—æ®µæ˜¯æœ‰åºæŽ’åˆ—ï¼Œ`b`å­—æ®µæ˜¯æ— åºæŽ’åˆ—(å› ä¸ºB+æ ‘åªèƒ½é€‰æ‹©ä¸€ä¸ªå­—æ®µæ¥æž„å»ºæœ‰åºçš„æ ‘)

åŒæ—¶é€šè¿‡è§‚å¯Ÿè¿˜å¯ä»¥å‘çŽ°ï¼Œ**åœ¨aç›¸ç­‰çš„æƒ…å†µä¸‹ï¼Œbå­—æ®µæ˜¯æœ‰åºçš„**ï¼Œå³æ­¤æ—¶`a=1`æ—¶ï¼Œ`b=1ï¼Œ2`ï¼Œbä¿æŒç›¸å¯¹æœ‰åºã€‚

åœ¨å¹³æ—¶çš„sqlä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæœ‰ä¸ªå…±è¯†ï¼Œå½“è¦å¯¹ä¸¤ä¸ªå­—æ®µè¿›è¡ŒæŽ’åºæ—¶ï¼Œé¦–å…ˆä¼šæŒ‰ç…§ç¬¬ä¸€ä¸ªå­—æ®µæŽ’åºï¼Œå¦‚æžœç¬¬ä¸€ä¸ªå­—æ®µç›¸ç­‰ï¼Œåˆ™ç”¨ç¬¬äºŒä¸ªå­—æ®µæŽ’åºã€‚

è¿™ç§å…±è¯†çš„åŽŸç†å°±æ˜¯å› ä¸ºï¼Œè”åˆå¤šå­—æ®µå»ºæ ‘æ—¶B+æ ‘çš„ç‹¬ç‰¹æž„å»ºæ–¹å¼ã€‚

### æœ€å·¦å‰ç¼€åŽŸåˆ™

æœ‰äº†è”åˆç´¢å¼•çš„æ¦‚å¿µï¼Œæœ€å·¦å‰ç¼€åŽŸåˆ™å°±å¥½ç†è§£äº†ï¼Œç”±äºŽB+æ ‘çš„å»ºæ ‘æ–¹å¼ï¼Œåªæœ‰å¶å­èŠ‚ç‚¹å­˜å‚¨æ•°æ®ï¼Œä¸”å¶å­èŠ‚ç‚¹ä»Žå·¦å¾€å³æŽ’åºä¿æŒé¡ºåºï¼Œæ˜¯æœ€å·¦å‰ç¼€åŒ¹é…çš„æ ¹æœ¬åŽŸå› ã€‚

å¦‚æžœè¦æŸ¥è¯¢`a`å­—æ®µæ‰€æœ‰ä»¥`1`å¼€å¤´çš„æ•°æ®ï¼Œåˆ™å¯¹åº”çš„`sql`æ¡ä»¶ä¸º`where a like '1%'`ã€‚è¿™ä¸ªæ—¶å€™ç´¢å¼•èƒ½å¤Ÿç”¨ä¸Šï¼ŒæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„è®°å½•ä¸º`ID-1`,ç„¶åŽä¸€ç›´å‘åŽéåŽ†ï¼Œç›´åˆ°ä¸æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã€‚

å†ä¸¾ä¸€ä¸ªèƒ½èµ°è”åˆç´¢å¼•çš„ä¾‹å­ï¼Œå¦‚`select * from student where a=1 and b=2`ã€‚

- é¦–å…ˆaå­—æ®µåœ¨B+æ ‘ä¸Šæ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ¥å®šä½åˆ°a=1çš„ä½ç½®ï¼Œå…¶æ¬¡åœ¨aç¡®å®šçš„æƒ…å†µä¸‹ï¼Œbæ˜¯ç›¸å¯¹æœ‰åºçš„ã€‚å› ä¸ºæœ‰åºï¼Œæ‰€ä»¥æˆ‘ä»¬åŒæ ·å¯ä»¥é€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°b=2çš„ä½ç½®ã€‚æ­¤æ—¶ç´¢å¼•æ˜¯æœ‰æ•ˆçš„ã€‚


å†ä¸¾ä¸€ä¸ªä¸èƒ½èµ°è”åˆç´¢å¼•çš„ä¾‹å­ï¼Œå¦‚`select * from student where b=2`ã€‚

- bå­—æ®µæœ‰åºçš„å‰ææ˜¯ï¼šåœ¨aç¡®å®šçš„æƒ…å†µä¸‹ï¼ŒçŽ°åœ¨æŸ¥è¯¢æ¡ä»¶ä¸­å¹¶æ²¡æœ‰è§„å®šaçš„èŒƒå›´ï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•ç¡®å®šbçš„é¡ºåºï¼Œåœ¨ä¸€æ£µæ— åºçš„B+æ ‘ä¸Šæ˜¯æ— æ³•ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥å®šä½åˆ°bå­—æ®µçš„ï¼Œè¿™ä¸ªæ—¶å€™ç´¢å¼•å¤±æ•ˆã€‚


### ç´¢å¼•ä¸‹æŽ¨

æœ€å·¦å‰ç¼€å¯ä»¥ç”¨åœ¨ç´¢å¼•ä¸­å®šä½è®°å½•ï¼Œé‚£ä¹ˆé‚£äº›ä¸ç¬¦åˆæœ€å·¦å‰ç¼€çš„éƒ¨åˆ†ä¼šæ€Žä¹ˆæ ·å‘¢ï¼Ÿ

è¿˜æ˜¯ä»¥è”åˆç´¢å¼•(a, b)ä¸ºä¾‹ï¼Œå‡è®¾çŽ°åœ¨è¡¨å†…æœ‰`a,b,c,d...`å¤šä¸ªå­—æ®µï¼Œå¦‚æžœçŽ°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šæ£€ç´¢å‡ºè¡¨ä¸­aå­—æ®µç¬¬ä¸€ä¸ªæ•°å­—ä¸º1ï¼Œä¸”bå­—æ®µä¸º2ï¼Œcå­—æ®µä¸º3çš„æ‰€æœ‰æ•°æ®ã€‚é‚£ä¹ˆè¿™æ¡Sqlè¯­å¥åˆ™æ˜¯è¿™ä¹ˆå†™çš„ï¼š

```sql
select * from student where a like '1%' and b=2 and c=3;
```

æ ¹æ®å‰ç¼€è§„åˆ™ï¼Œè¿™ä¸ªè¯­å¥åœ¨æœç´¢ç´¢å¼•æ ‘æ—¶ï¼Œåªèƒ½ç”¨`1`ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•`ID-1`ã€‚

ä¹‹åŽåˆ™éœ€è¦åˆ¤æ–­å…¶ä»–æ¡ä»¶æ˜¯å¦æ»¡è¶³ã€‚åœ¨MySQL5.6ä¹‹å‰ï¼Œåªèƒ½ä»ŽID1å¼€å§‹ä¸€ä¸ªä¸ªå›žè¡¨ã€‚åˆ°ä¸»é”®ç´¢å¼•ä¸Šæ‰¾å‡ºæ•°æ®è¡Œï¼Œå†å¯¹æ¯”å­—æ®µå€¼ã€‚

è€ŒMySQL5.6å¼•å…¥çš„ç´¢å¼•ä¸‹æŽ¨ä¼˜åŒ–(index condition pushdown)ï¼Œå¯ä»¥åœ¨ç´¢å¼•éåŽ†è¿‡ç¨‹ä¸­ï¼Œå¯¹ç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µå…ˆåšåˆ¤æ–­ï¼Œç›´æŽ¥è¿‡æ»¤æŽ‰ä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå‡å°‘å›žè¡¨æ¬¡æ•°ã€‚

è¿™ä¸¤ä¸ªè¿‡ç¨‹å¯å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

æ— ç´¢å¼•ä¸‹æŽ¨è¿‡ç¨‹ï¼Œå‡éœ€è¦å›žè¡¨

::: center
![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-nounder.png)
:::

ç´¢å¼•ä¸‹æŽ¨è¿‡ç¨‹

::: center
![](https://image-1-1257237419.cos.ap-chongqing.myqcloud.com/img/mysql-under.png)
:::

åœ¨è¿™ä¸¤ä¸ªå›¾ä¸­ï¼Œæ¯ä¸ªç®­å¤´è¡¨ç¤ºå›žè¡¨ä¸€æ¬¡

åœ¨æ— ç´¢å¼•ä¸‹æŽ¨è¿‡ç¨‹ä¸­ï¼ŒInnoDBåªéœ€è¦è§‚å¯Ÿ`a`å­—æ®µçš„å€¼ï¼ŒæŒ‰é¡ºåºæŠŠ`a`å­—æ®µç¬¬ä¸€ä¸ªæ•°å€¼ä¸º`1`çš„è®°å½•ä¸€æ¡æ¡å–å‡ºæ¥è¿›è¡Œå›žè¡¨ï¼Œæ‰€ä»¥æ€»è®¡éœ€è¦å›žè¡¨2æ¬¡ã€‚

ç´¢å¼•ä¸‹æŽ¨è¿‡ç¨‹çš„åŒºåˆ«åœ¨äºŽï¼ŒInnoDBåœ¨(a, b)ç´¢å¼•å†…éƒ¨å°±åˆ¤æ–­äº†`b`å­—æ®µæ˜¯å¦ç­‰äºŽ2ï¼Œå¯¹äºŽä¸ç­‰äºŽ2çš„è®°å½•ï¼Œç›´æŽ¥åˆ¤æ–­å¹¶è·³è¿‡ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªéœ€è¦å¯¹ID-2è¿™ä¸€æ¡è®°å½•å›žè¡¨å–æ•°æ®åˆ¤æ–­ï¼Œåªéœ€è¦å›žè¡¨1æ¬¡ã€‚

### ç´¢å¼•åˆ†æž

### ç´¢å¼•å¤±æ•ˆåœºæ™¯

## å‚è€ƒæ–‡ç« 

> ã€ŠMySQL45è®²ã€‹
>
> https://www.cnblogs.com/aaabbbcccddd/p/14864982.html
>
> https://www.jb51.net/article/229580.htm
>
> https://mp.weixin.qq.com/s/SSHWKcuGK5x4Uf7ZBC7stQ
>
> <https://blog.csdn.net/q736317048/article/details/114415571>
>
> <https://www.cnblogs.com/heishuichenzhou/p/10813463.html>
>
> https://mp.weixin.qq.com/s/tD_yDXBYfmLqN3BHmhOnfQ


